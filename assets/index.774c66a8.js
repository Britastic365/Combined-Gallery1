import{g as Rt,t as ke,c as Ue,d as $r,f as qs,e as Br,h as bn,b as Ur,s as Hr}from"./content-script-helpers.c46a6994.js";import{m as xe,o as D,c as L,a as S,_ as Te,d as ce,f as _e,p as zr,b as rt,u as z,g as jr,t as ye,j as vt,bz as on,e as Ce,w as oe,h as ve,n as Wr,v as yn,F as Fs,i as $s,q as Gr,I as Yr,bH as es}from"./lodash.4793ee9f.js";import{F as Vr}from"./FileSaver.min.95614790.js";import{F as Xr}from"./fuse.esm.249bd5bb.js";import{c as Jr}from"./tippy.0141f121.js";function nt(t,e){var a,l,c,u,f,p,h,m;const n=Rt(),s=(m=(h=(u=(c=e==null?void 0:e.weekStartsOn)!=null?c:(l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)!=null?u:n.weekStartsOn)!=null?h:(p=(f=n.locale)==null?void 0:f.options)==null?void 0:p.weekStartsOn)!=null?m:0,r=ke(t,e==null?void 0:e.in),i=r.getDay(),o=(i<s?7:0)+i-s;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function kt(t,e){return nt(t,{...e,weekStartsOn:1})}function Bs(t,e){const n=ke(t,e==null?void 0:e.in),s=n.getFullYear(),r=Ue(n,0);r.setFullYear(s+1,0,4),r.setHours(0,0,0,0);const i=kt(r),o=Ue(n,0);o.setFullYear(s,0,4),o.setHours(0,0,0,0);const a=kt(o);return n.getTime()>=i.getTime()?s+1:n.getTime()>=a.getTime()?s:s-1}function Qr(t,e){const n=Bs(t,e),s=Ue((e==null?void 0:e.in)||t,0);return s.setFullYear(n,0,4),s.setHours(0,0,0,0),kt(s)}function Kr(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Zr(t){return!(!Kr(t)&&typeof t!="number"||isNaN(+ke(t)))}function ei(t,e){const n=ke(t,e==null?void 0:e.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function ti(t,e){const n=ke(t,e==null?void 0:e.in);return $r(n,ei(n))+1}function ni(t,e){const n=ke(t,e==null?void 0:e.in),s=+kt(n)-+Qr(n);return Math.round(s/qs)+1}function Us(t,e){var u,f,p,h,m,g,y,v;const n=ke(t,e==null?void 0:e.in),s=n.getFullYear(),r=Rt(),i=(v=(y=(h=(p=e==null?void 0:e.firstWeekContainsDate)!=null?p:(f=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)!=null?h:r.firstWeekContainsDate)!=null?y:(g=(m=r.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)!=null?v:1,o=Ue((e==null?void 0:e.in)||t,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const a=nt(o,e),l=Ue((e==null?void 0:e.in)||t,0);l.setFullYear(s,0,i),l.setHours(0,0,0,0);const c=nt(l,e);return+n>=+a?s+1:+n>=+c?s:s-1}function si(t,e){var a,l,c,u,f,p,h,m;const n=Rt(),s=(m=(h=(u=(c=e==null?void 0:e.firstWeekContainsDate)!=null?c:(l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)!=null?u:n.firstWeekContainsDate)!=null?h:(p=(f=n.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)!=null?m:1,r=Us(t,e),i=Ue((e==null?void 0:e.in)||t,0);return i.setFullYear(r,0,s),i.setHours(0,0,0,0),nt(i,e)}function ri(t,e){const n=ke(t,e==null?void 0:e.in),s=+nt(n,e)-+si(n,e);return Math.round(s/qs)+1}function H(t,e){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(e,"0");return n+s}const Ee={y(t,e){const n=t.getFullYear(),s=n>0?n:1-n;return H(e==="yy"?s%100:s,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):H(n+1,2)},d(t,e){return H(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return H(t.getHours()%12||12,e.length)},H(t,e){return H(t.getHours(),e.length)},m(t,e){return H(t.getMinutes(),e.length)},s(t,e){return H(t.getSeconds(),e.length)},S(t,e){const n=e.length,s=t.getMilliseconds(),r=Math.trunc(s*Math.pow(10,n-3));return H(r,e.length)}},Be={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ts={G:function(t,e,n){const s=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const s=t.getFullYear(),r=s>0?s:1-s;return n.ordinalNumber(r,{unit:"year"})}return Ee.y(t,e)},Y:function(t,e,n,s){const r=Us(t,s),i=r>0?r:1-r;if(e==="YY"){const o=i%100;return H(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):H(i,e.length)},R:function(t,e){const n=Bs(t);return H(n,e.length)},u:function(t,e){const n=t.getFullYear();return H(n,e.length)},Q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return H(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return H(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,e,n){const s=t.getMonth();switch(e){case"M":case"MM":return Ee.M(t,e);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,e,n){const s=t.getMonth();switch(e){case"L":return String(s+1);case"LL":return H(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,e,n,s){const r=ri(t,s);return e==="wo"?n.ordinalNumber(r,{unit:"week"}):H(r,e.length)},I:function(t,e,n){const s=ni(t);return e==="Io"?n.ordinalNumber(s,{unit:"week"}):H(s,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Ee.d(t,e)},D:function(t,e,n){const s=ti(t);return e==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):H(s,e.length)},E:function(t,e,n){const s=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,e,n,s){const r=t.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return H(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,s){const r=t.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return H(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const s=t.getDay(),r=s===0?7:s;switch(e){case"i":return String(r);case"ii":return H(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,e,n){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(t,e,n){const s=t.getHours();let r;switch(s===12?r=Be.noon:s===0?r=Be.midnight:r=s/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const s=t.getHours();let r;switch(s>=17?r=Be.evening:s>=12?r=Be.afternoon:s>=4?r=Be.morning:r=Be.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return Ee.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Ee.H(t,e)},K:function(t,e,n){const s=t.getHours()%12;return e==="Ko"?n.ordinalNumber(s,{unit:"hour"}):H(s,e.length)},k:function(t,e,n){let s=t.getHours();return s===0&&(s=24),e==="ko"?n.ordinalNumber(s,{unit:"hour"}):H(s,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Ee.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Ee.s(t,e)},S:function(t,e){return Ee.S(t,e)},X:function(t,e,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return ss(s);case"XXXX":case"XX":return Oe(s);case"XXXXX":case"XXX":default:return Oe(s,":")}},x:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"x":return ss(s);case"xxxx":case"xx":return Oe(s);case"xxxxx":case"xxx":default:return Oe(s,":")}},O:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+ns(s,":");case"OOOO":default:return"GMT"+Oe(s,":")}},z:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+ns(s,":");case"zzzz":default:return"GMT"+Oe(s,":")}},t:function(t,e,n){const s=Math.trunc(+t/1e3);return H(s,e.length)},T:function(t,e,n){return H(+t,e.length)}};function ns(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=Math.trunc(s/60),i=s%60;return i===0?n+String(r):n+String(r)+e+H(i,2)}function ss(t,e){return t%60===0?(t>0?"-":"+")+H(Math.abs(t)/60,2):Oe(t,e)}function Oe(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=H(Math.trunc(s/60),2),i=H(s%60,2);return n+r+e+i}const rs=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Hs=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},ii=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],r=n[2];if(!r)return rs(t,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",rs(s,e)).replace("{{time}}",Hs(r,e))},oi={p:Hs,P:ii},ai=/^D+$/,li=/^Y+$/,ci=["D","DD","YY","YYYY"];function ui(t){return ai.test(t)}function di(t){return li.test(t)}function fi(t,e,n){const s=pi(t,e,n);if(console.warn(s),ci.includes(t))throw new RangeError(s)}function pi(t,e,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const mi=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,hi=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,gi=/^'([^]*?)'?$/,bi=/''/g,yi=/[a-zA-Z]/;function Ou(t,e,n){var u,f,p,h,m,g,y,v,T,O,w,E,N,U,j,R,C,B;const s=Rt(),r=(f=(u=n==null?void 0:n.locale)!=null?u:s.locale)!=null?f:Br,i=(O=(T=(g=(m=n==null?void 0:n.firstWeekContainsDate)!=null?m:(h=(p=n==null?void 0:n.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)!=null?g:s.firstWeekContainsDate)!=null?T:(v=(y=s.locale)==null?void 0:y.options)==null?void 0:v.firstWeekContainsDate)!=null?O:1,o=(B=(C=(U=(N=n==null?void 0:n.weekStartsOn)!=null?N:(E=(w=n==null?void 0:n.locale)==null?void 0:w.options)==null?void 0:E.weekStartsOn)!=null?U:s.weekStartsOn)!=null?C:(R=(j=s.locale)==null?void 0:j.options)==null?void 0:R.weekStartsOn)!=null?B:0,a=ke(t,n==null?void 0:n.in);if(!Zr(a))throw new RangeError("Invalid time value");let l=e.match(hi).map(q=>{const G=q[0];if(G==="p"||G==="P"){const me=oi[G];return me(q,r.formatLong)}return q}).join("").match(mi).map(q=>{if(q==="''")return{isToken:!1,value:"'"};const G=q[0];if(G==="'")return{isToken:!1,value:_i(q)};if(ts[G])return{isToken:!0,value:q};if(G.match(yi))throw new RangeError("Format string contains an unescaped latin alphabet character `"+G+"`");return{isToken:!1,value:q}});r.localize.preprocessor&&(l=r.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:r};return l.map(q=>{if(!q.isToken)return q.value;const G=q.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&di(G)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&ui(G))&&fi(G,e,String(t));const me=ts[G[0]];return me(a,G,r.localize,c)}).join("")}function _i(t){const e=t.match(gi);return e?e[1].replace(bi,"'"):t}function zs(t,e){return function(){return t.apply(e,arguments)}}const{toString:xi}=Object.prototype,{getPrototypeOf:_n}=Object,Dt=(t=>e=>{const n=xi.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),pe=t=>(t=t.toLowerCase(),e=>Dt(e)===t),Pt=t=>e=>typeof e===t,{isArray:He}=Array,st=Pt("undefined");function wi(t){return t!==null&&!st(t)&&t.constructor!==null&&!st(t.constructor)&&ae(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const js=pe("ArrayBuffer");function Si(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&js(t.buffer),e}const vi=Pt("string"),ae=Pt("function"),Ws=Pt("number"),Ct=t=>t!==null&&typeof t=="object",ki=t=>t===!0||t===!1,yt=t=>{if(Dt(t)!=="object")return!1;const e=_n(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Ti=pe("Date"),Ei=pe("File"),Ai=pe("Blob"),Oi=pe("FileList"),Ri=t=>Ct(t)&&ae(t.pipe),Di=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||ae(t.append)&&((e=Dt(t))==="formdata"||e==="object"&&ae(t.toString)&&t.toString()==="[object FormData]"))},Pi=pe("URLSearchParams"),[Ci,Li,Ni,Mi]=["ReadableStream","Request","Response","Headers"].map(pe),Ii=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function it(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let s,r;if(typeof t!="object"&&(t=[t]),He(t))for(s=0,r=t.length;s<r;s++)e.call(null,t[s],s,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let a;for(s=0;s<o;s++)a=i[s],e.call(null,t[a],a,t)}}function Gs(t,e){e=e.toLowerCase();const n=Object.keys(t);let s=n.length,r;for(;s-- >0;)if(r=n[s],e===r.toLowerCase())return r;return null}const Pe=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Ys=t=>!st(t)&&t!==Pe;function an(){const{caseless:t}=Ys(this)&&this||{},e={},n=(s,r)=>{const i=t&&Gs(e,r)||r;yt(e[i])&&yt(s)?e[i]=an(e[i],s):yt(s)?e[i]=an({},s):He(s)?e[i]=s.slice():e[i]=s};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&it(arguments[s],n);return e}const qi=(t,e,n,{allOwnKeys:s}={})=>(it(e,(r,i)=>{n&&ae(r)?t[i]=zs(r,n):t[i]=r},{allOwnKeys:s}),t),Fi=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),$i=(t,e,n,s)=>{t.prototype=Object.create(e.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},Bi=(t,e,n,s)=>{let r,i,o;const a={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),i=r.length;i-- >0;)o=r[i],(!s||s(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&_n(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},Ui=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const s=t.indexOf(e,n);return s!==-1&&s===n},Hi=t=>{if(!t)return null;if(He(t))return t;let e=t.length;if(!Ws(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},zi=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&_n(Uint8Array)),ji=(t,e)=>{const s=(t&&t[Symbol.iterator]).call(t);let r;for(;(r=s.next())&&!r.done;){const i=r.value;e.call(t,i[0],i[1])}},Wi=(t,e)=>{let n;const s=[];for(;(n=t.exec(e))!==null;)s.push(n);return s},Gi=pe("HTMLFormElement"),Yi=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),is=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),Vi=pe("RegExp"),Vs=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),s={};it(n,(r,i)=>{let o;(o=e(r,i,t))!==!1&&(s[i]=o||r)}),Object.defineProperties(t,s)},Xi=t=>{Vs(t,(e,n)=>{if(ae(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=t[n];if(!!ae(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Ji=(t,e)=>{const n={},s=r=>{r.forEach(i=>{n[i]=!0})};return He(t)?s(t):s(String(t).split(e)),n},Qi=()=>{},Ki=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,Xt="abcdefghijklmnopqrstuvwxyz",os="0123456789",Xs={DIGIT:os,ALPHA:Xt,ALPHA_DIGIT:Xt+Xt.toUpperCase()+os},Zi=(t=16,e=Xs.ALPHA_DIGIT)=>{let n="";const{length:s}=e;for(;t--;)n+=e[Math.random()*s|0];return n};function eo(t){return!!(t&&ae(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const to=t=>{const e=new Array(10),n=(s,r)=>{if(Ct(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[r]=s;const i=He(s)?[]:{};return it(s,(o,a)=>{const l=n(o,r+1);!st(l)&&(i[a]=l)}),e[r]=void 0,i}}return s};return n(t,0)},no=pe("AsyncFunction"),so=t=>t&&(Ct(t)||ae(t))&&ae(t.then)&&ae(t.catch),Js=((t,e)=>t?setImmediate:e?((n,s)=>(Pe.addEventListener("message",({source:r,data:i})=>{r===Pe&&i===n&&s.length&&s.shift()()},!1),r=>{s.push(r),Pe.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",ae(Pe.postMessage)),ro=typeof queueMicrotask<"u"?queueMicrotask.bind(Pe):typeof process<"u"&&process.nextTick||Js,b={isArray:He,isArrayBuffer:js,isBuffer:wi,isFormData:Di,isArrayBufferView:Si,isString:vi,isNumber:Ws,isBoolean:ki,isObject:Ct,isPlainObject:yt,isReadableStream:Ci,isRequest:Li,isResponse:Ni,isHeaders:Mi,isUndefined:st,isDate:Ti,isFile:Ei,isBlob:Ai,isRegExp:Vi,isFunction:ae,isStream:Ri,isURLSearchParams:Pi,isTypedArray:zi,isFileList:Oi,forEach:it,merge:an,extend:qi,trim:Ii,stripBOM:Fi,inherits:$i,toFlatObject:Bi,kindOf:Dt,kindOfTest:pe,endsWith:Ui,toArray:Hi,forEachEntry:ji,matchAll:Wi,isHTMLForm:Gi,hasOwnProperty:is,hasOwnProp:is,reduceDescriptors:Vs,freezeMethods:Xi,toObjectSet:Ji,toCamelCase:Yi,noop:Qi,toFiniteNumber:Ki,findKey:Gs,global:Pe,isContextDefined:Ys,ALPHABET:Xs,generateString:Zi,isSpecCompliantForm:eo,toJSONObject:to,isAsyncFn:no,isThenable:so,setImmediate:Js,asap:ro};function P(t,e,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}b.inherits(P,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:b.toJSONObject(this.config),code:this.code,status:this.status}}});const Qs=P.prototype,Ks={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Ks[t]={value:t}});Object.defineProperties(P,Ks);Object.defineProperty(Qs,"isAxiosError",{value:!0});P.from=(t,e,n,s,r,i)=>{const o=Object.create(Qs);return b.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),P.call(o,t.message,e,n,s,r),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const io=null;function ln(t){return b.isPlainObject(t)||b.isArray(t)}function Zs(t){return b.endsWith(t,"[]")?t.slice(0,-2):t}function as(t,e,n){return t?t.concat(e).map(function(r,i){return r=Zs(r),!n&&i?"["+r+"]":r}).join(n?".":""):e}function oo(t){return b.isArray(t)&&!t.some(ln)}const ao=b.toFlatObject(b,{},null,function(e){return/^is[A-Z]/.test(e)});function Lt(t,e,n){if(!b.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=b.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!b.isUndefined(y[g])});const s=n.metaTokens,r=n.visitor||u,i=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&b.isSpecCompliantForm(e);if(!b.isFunction(r))throw new TypeError("visitor must be a function");function c(m){if(m===null)return"";if(b.isDate(m))return m.toISOString();if(!l&&b.isBlob(m))throw new P("Blob is not supported. Use a Buffer instead.");return b.isArrayBuffer(m)||b.isTypedArray(m)?l&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,g,y){let v=m;if(m&&!y&&typeof m=="object"){if(b.endsWith(g,"{}"))g=s?g:g.slice(0,-2),m=JSON.stringify(m);else if(b.isArray(m)&&oo(m)||(b.isFileList(m)||b.endsWith(g,"[]"))&&(v=b.toArray(m)))return g=Zs(g),v.forEach(function(O,w){!(b.isUndefined(O)||O===null)&&e.append(o===!0?as([g],w,i):o===null?g:g+"[]",c(O))}),!1}return ln(m)?!0:(e.append(as(y,g,i),c(m)),!1)}const f=[],p=Object.assign(ao,{defaultVisitor:u,convertValue:c,isVisitable:ln});function h(m,g){if(!b.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(m),b.forEach(m,function(v,T){(!(b.isUndefined(v)||v===null)&&r.call(e,v,b.isString(T)?T.trim():T,g,p))===!0&&h(v,g?g.concat(T):[T])}),f.pop()}}if(!b.isObject(t))throw new TypeError("data must be an object");return h(t),e}function ls(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function xn(t,e){this._pairs=[],t&&Lt(t,this,e)}const er=xn.prototype;er.append=function(e,n){this._pairs.push([e,n])};er.toString=function(e){const n=e?function(s){return e.call(this,s,ls)}:ls;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function lo(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function tr(t,e,n){if(!e)return t;const s=n&&n.encode||lo;b.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let i;if(r?i=r(e,n):i=b.isURLSearchParams(e)?e.toString():new xn(e,n).toString(s),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class co{constructor(){this.handlers=[]}use(e,n,s){return this.handlers.push({fulfilled:e,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){b.forEach(this.handlers,function(s){s!==null&&e(s)})}}const cs=co,nr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},uo=typeof URLSearchParams<"u"?URLSearchParams:xn,fo=typeof FormData<"u"?FormData:null,po=typeof Blob<"u"?Blob:null,mo={isBrowser:!0,classes:{URLSearchParams:uo,FormData:fo,Blob:po},protocols:["http","https","file","blob","url","data"]},wn=typeof window<"u"&&typeof document<"u",cn=typeof navigator=="object"&&navigator||void 0,ho=wn&&(!cn||["ReactNative","NativeScript","NS"].indexOf(cn.product)<0),go=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),bo=wn&&window.location.href||"http://localhost",yo=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wn,hasStandardBrowserWebWorkerEnv:go,hasStandardBrowserEnv:ho,navigator:cn,origin:bo},Symbol.toStringTag,{value:"Module"})),ee={...yo,...mo};function _o(t,e){return Lt(t,new ee.classes.URLSearchParams,Object.assign({visitor:function(n,s,r,i){return ee.isNode&&b.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function xo(t){return b.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function wo(t){const e={},n=Object.keys(t);let s;const r=n.length;let i;for(s=0;s<r;s++)i=n[s],e[i]=t[i];return e}function sr(t){function e(n,s,r,i){let o=n[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=i>=n.length;return o=!o&&b.isArray(r)?r.length:o,l?(b.hasOwnProp(r,o)?r[o]=[r[o],s]:r[o]=s,!a):((!r[o]||!b.isObject(r[o]))&&(r[o]=[]),e(n,s,r[o],i)&&b.isArray(r[o])&&(r[o]=wo(r[o])),!a)}if(b.isFormData(t)&&b.isFunction(t.entries)){const n={};return b.forEachEntry(t,(s,r)=>{e(xo(s),r,n,0)}),n}return null}function So(t,e,n){if(b.isString(t))try{return(e||JSON.parse)(t),b.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(t)}const Sn={transitional:nr,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,i=b.isObject(e);if(i&&b.isHTMLForm(e)&&(e=new FormData(e)),b.isFormData(e))return r?JSON.stringify(sr(e)):e;if(b.isArrayBuffer(e)||b.isBuffer(e)||b.isStream(e)||b.isFile(e)||b.isBlob(e)||b.isReadableStream(e))return e;if(b.isArrayBufferView(e))return e.buffer;if(b.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return _o(e,this.formSerializer).toString();if((a=b.isFileList(e))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Lt(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||r?(n.setContentType("application/json",!1),So(e)):e}],transformResponse:[function(e){const n=this.transitional||Sn.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(b.isResponse(e)||b.isReadableStream(e))return e;if(e&&b.isString(e)&&(s&&!this.responseType||r)){const o=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?P.from(a,P.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ee.classes.FormData,Blob:ee.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};b.forEach(["delete","get","head","post","put","patch"],t=>{Sn.headers[t]={}});const vn=Sn,vo=b.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ko=t=>{const e={};let n,s,r;return t&&t.split(`
`).forEach(function(o){r=o.indexOf(":"),n=o.substring(0,r).trim().toLowerCase(),s=o.substring(r+1).trim(),!(!n||e[n]&&vo[n])&&(n==="set-cookie"?e[n]?e[n].push(s):e[n]=[s]:e[n]=e[n]?e[n]+", "+s:s)}),e},us=Symbol("internals");function Xe(t){return t&&String(t).trim().toLowerCase()}function _t(t){return t===!1||t==null?t:b.isArray(t)?t.map(_t):String(t)}function To(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(t);)e[s[1]]=s[2];return e}const Eo=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Jt(t,e,n,s,r){if(b.isFunction(s))return s.call(this,e,n);if(r&&(e=n),!!b.isString(e)){if(b.isString(s))return e.indexOf(s)!==-1;if(b.isRegExp(s))return s.test(e)}}function Ao(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,s)=>n.toUpperCase()+s)}function Oo(t,e){const n=b.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+n,{value:function(r,i,o){return this[s].call(this,e,r,i,o)},configurable:!0})})}class Nt{constructor(e){e&&this.set(e)}set(e,n,s){const r=this;function i(a,l,c){const u=Xe(l);if(!u)throw new Error("header name must be a non-empty string");const f=b.findKey(r,u);(!f||r[f]===void 0||c===!0||c===void 0&&r[f]!==!1)&&(r[f||l]=_t(a))}const o=(a,l)=>b.forEach(a,(c,u)=>i(c,u,l));if(b.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(b.isString(e)&&(e=e.trim())&&!Eo(e))o(ko(e),n);else if(b.isHeaders(e))for(const[a,l]of e.entries())i(l,a,s);else e!=null&&i(n,e,s);return this}get(e,n){if(e=Xe(e),e){const s=b.findKey(this,e);if(s){const r=this[s];if(!n)return r;if(n===!0)return To(r);if(b.isFunction(n))return n.call(this,r,s);if(b.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Xe(e),e){const s=b.findKey(this,e);return!!(s&&this[s]!==void 0&&(!n||Jt(this,this[s],s,n)))}return!1}delete(e,n){const s=this;let r=!1;function i(o){if(o=Xe(o),o){const a=b.findKey(s,o);a&&(!n||Jt(s,s[a],a,n))&&(delete s[a],r=!0)}}return b.isArray(e)?e.forEach(i):i(e),r}clear(e){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const i=n[s];(!e||Jt(this,this[i],i,e,!0))&&(delete this[i],r=!0)}return r}normalize(e){const n=this,s={};return b.forEach(this,(r,i)=>{const o=b.findKey(s,i);if(o){n[o]=_t(r),delete n[i];return}const a=e?Ao(i):String(i).trim();a!==i&&delete n[i],n[a]=_t(r),s[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return b.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=e&&b.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[us]=this[us]={accessors:{}}).accessors,r=this.prototype;function i(o){const a=Xe(o);s[a]||(Oo(r,o),s[a]=!0)}return b.isArray(e)?e.forEach(i):i(e),this}}Nt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);b.reduceDescriptors(Nt.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[n]=s}}});b.freezeMethods(Nt);const fe=Nt;function Qt(t,e){const n=this||vn,s=e||n,r=fe.from(s.headers);let i=s.data;return b.forEach(t,function(a){i=a.call(n,i,r.normalize(),e?e.status:void 0)}),r.normalize(),i}function rr(t){return!!(t&&t.__CANCEL__)}function ze(t,e,n){P.call(this,t==null?"canceled":t,P.ERR_CANCELED,e,n),this.name="CanceledError"}b.inherits(ze,P,{__CANCEL__:!0});function ir(t,e,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):e(new P("Request failed with status code "+n.status,[P.ERR_BAD_REQUEST,P.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Ro(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Do(t,e){t=t||10;const n=new Array(t),s=new Array(t);let r=0,i=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=s[i];o||(o=c),n[r]=l,s[r]=c;let f=i,p=0;for(;f!==r;)p+=n[f++],f=f%t;if(r=(r+1)%t,r===i&&(i=(i+1)%t),c-o<e)return;const h=u&&c-u;return h?Math.round(p*1e3/h):void 0}}function Po(t,e){let n=0,s=1e3/e,r,i;const o=(c,u=Date.now())=>{n=u,r=null,i&&(clearTimeout(i),i=null),t.apply(null,c)};return[(...c)=>{const u=Date.now(),f=u-n;f>=s?o(c,u):(r=c,i||(i=setTimeout(()=>{i=null,o(r)},s-f)))},()=>r&&o(r)]}const Tt=(t,e,n=3)=>{let s=0;const r=Do(50,250);return Po(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,l=o-s,c=r(l),u=o<=a;s=o;const f={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:i,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(f)},n)},ds=(t,e)=>{const n=t!=null;return[s=>e[0]({lengthComputable:n,total:t,loaded:s}),e[1]]},fs=t=>(...e)=>b.asap(()=>t(...e)),Co=ee.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,ee.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(ee.origin),ee.navigator&&/(msie|trident)/i.test(ee.navigator.userAgent)):()=>!0,Lo=ee.hasStandardBrowserEnv?{write(t,e,n,s,r,i){const o=[t+"="+encodeURIComponent(e)];b.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),b.isString(s)&&o.push("path="+s),b.isString(r)&&o.push("domain="+r),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function No(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Mo(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function or(t,e){return t&&!No(e)?Mo(t,e):e}const ps=t=>t instanceof fe?{...t}:t;function Le(t,e){e=e||{};const n={};function s(c,u,f,p){return b.isPlainObject(c)&&b.isPlainObject(u)?b.merge.call({caseless:p},c,u):b.isPlainObject(u)?b.merge({},u):b.isArray(u)?u.slice():u}function r(c,u,f,p){if(b.isUndefined(u)){if(!b.isUndefined(c))return s(void 0,c,f,p)}else return s(c,u,f,p)}function i(c,u){if(!b.isUndefined(u))return s(void 0,u)}function o(c,u){if(b.isUndefined(u)){if(!b.isUndefined(c))return s(void 0,c)}else return s(void 0,u)}function a(c,u,f){if(f in e)return s(c,u);if(f in t)return s(void 0,c)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u,f)=>r(ps(c),ps(u),f,!0)};return b.forEach(Object.keys(Object.assign({},t,e)),function(u){const f=l[u]||r,p=f(t[u],e[u],u);b.isUndefined(p)&&f!==a||(n[u]=p)}),n}const ar=t=>{const e=Le({},t);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:i,headers:o,auth:a}=e;e.headers=o=fe.from(o),e.url=tr(or(e.baseURL,e.url),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(b.isFormData(n)){if(ee.hasStandardBrowserEnv||ee.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...u]=l?l.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...u].join("; "))}}if(ee.hasStandardBrowserEnv&&(s&&b.isFunction(s)&&(s=s(e)),s||s!==!1&&Co(e.url))){const c=r&&i&&Lo.read(i);c&&o.set(r,c)}return e},Io=typeof XMLHttpRequest<"u",qo=Io&&function(t){return new Promise(function(n,s){const r=ar(t);let i=r.data;const o=fe.from(r.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=r,u,f,p,h,m;function g(){h&&h(),m&&m(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let y=new XMLHttpRequest;y.open(r.method.toUpperCase(),r.url,!0),y.timeout=r.timeout;function v(){if(!y)return;const O=fe.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),E={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:O,config:t,request:y};ir(function(U){n(U),g()},function(U){s(U),g()},E),y=null}"onloadend"in y?y.onloadend=v:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(v)},y.onabort=function(){!y||(s(new P("Request aborted",P.ECONNABORTED,t,y)),y=null)},y.onerror=function(){s(new P("Network Error",P.ERR_NETWORK,t,y)),y=null},y.ontimeout=function(){let w=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const E=r.transitional||nr;r.timeoutErrorMessage&&(w=r.timeoutErrorMessage),s(new P(w,E.clarifyTimeoutError?P.ETIMEDOUT:P.ECONNABORTED,t,y)),y=null},i===void 0&&o.setContentType(null),"setRequestHeader"in y&&b.forEach(o.toJSON(),function(w,E){y.setRequestHeader(E,w)}),b.isUndefined(r.withCredentials)||(y.withCredentials=!!r.withCredentials),a&&a!=="json"&&(y.responseType=r.responseType),c&&([p,m]=Tt(c,!0),y.addEventListener("progress",p)),l&&y.upload&&([f,h]=Tt(l),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",h)),(r.cancelToken||r.signal)&&(u=O=>{!y||(s(!O||O.type?new ze(null,t,y):O),y.abort(),y=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const T=Ro(r.url);if(T&&ee.protocols.indexOf(T)===-1){s(new P("Unsupported protocol "+T+":",P.ERR_BAD_REQUEST,t));return}y.send(i||null)})},Fo=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let s=new AbortController,r;const i=function(c){if(!r){r=!0,a();const u=c instanceof Error?c:this.reason;s.abort(u instanceof P?u:new ze(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,i(new P(`timeout ${e} of ms exceeded`,P.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),t=null)};t.forEach(c=>c.addEventListener("abort",i));const{signal:l}=s;return l.unsubscribe=()=>b.asap(a),l}},$o=Fo,Bo=function*(t,e){let n=t.byteLength;if(!e||n<e){yield t;return}let s=0,r;for(;s<n;)r=s+e,yield t.slice(s,r),s=r},Uo=async function*(t,e){for await(const n of Ho(t))yield*Bo(n,e)},Ho=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)break;yield s}}finally{await e.cancel()}},ms=(t,e,n,s)=>{const r=Uo(t,e);let i=0,o,a=l=>{o||(o=!0,s&&s(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await r.next();if(c){a(),l.close();return}let f=u.byteLength;if(n){let p=i+=f;n(p)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),r.return()}},{highWaterMark:2})},Mt=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",lr=Mt&&typeof ReadableStream=="function",zo=Mt&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),cr=(t,...e)=>{try{return!!t(...e)}catch{return!1}},jo=lr&&cr(()=>{let t=!1;const e=new Request(ee.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),hs=64*1024,un=lr&&cr(()=>b.isReadableStream(new Response("").body)),Et={stream:un&&(t=>t.body)};Mt&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Et[e]&&(Et[e]=b.isFunction(t[e])?n=>n[e]():(n,s)=>{throw new P(`Response type '${e}' is not supported`,P.ERR_NOT_SUPPORT,s)})})})(new Response);const Wo=async t=>{if(t==null)return 0;if(b.isBlob(t))return t.size;if(b.isSpecCompliantForm(t))return(await new Request(ee.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(b.isArrayBufferView(t)||b.isArrayBuffer(t))return t.byteLength;if(b.isURLSearchParams(t)&&(t=t+""),b.isString(t))return(await zo(t)).byteLength},Go=async(t,e)=>{const n=b.toFiniteNumber(t.getContentLength());return n==null?Wo(e):n},Yo=Mt&&(async t=>{let{url:e,method:n,data:s,signal:r,cancelToken:i,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:f="same-origin",fetchOptions:p}=ar(t);c=c?(c+"").toLowerCase():"text";let h=$o([r,i&&i.toAbortSignal()],o),m;const g=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let y;try{if(l&&jo&&n!=="get"&&n!=="head"&&(y=await Go(u,s))!==0){let E=new Request(e,{method:"POST",body:s,duplex:"half"}),N;if(b.isFormData(s)&&(N=E.headers.get("content-type"))&&u.setContentType(N),E.body){const[U,j]=ds(y,Tt(fs(l)));s=ms(E.body,hs,U,j)}}b.isString(f)||(f=f?"include":"omit");const v="credentials"in Request.prototype;m=new Request(e,{...p,signal:h,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:s,duplex:"half",credentials:v?f:void 0});let T=await fetch(m);const O=un&&(c==="stream"||c==="response");if(un&&(a||O&&g)){const E={};["status","statusText","headers"].forEach(R=>{E[R]=T[R]});const N=b.toFiniteNumber(T.headers.get("content-length")),[U,j]=a&&ds(N,Tt(fs(a),!0))||[];T=new Response(ms(T.body,hs,U,()=>{j&&j(),g&&g()}),E)}c=c||"text";let w=await Et[b.findKey(Et,c)||"text"](T,t);return!O&&g&&g(),await new Promise((E,N)=>{ir(E,N,{data:w,headers:fe.from(T.headers),status:T.status,statusText:T.statusText,config:t,request:m})})}catch(v){throw g&&g(),v&&v.name==="TypeError"&&/fetch/i.test(v.message)?Object.assign(new P("Network Error",P.ERR_NETWORK,t,m),{cause:v.cause||v}):P.from(v,v&&v.code,t,m)}}),dn={http:io,xhr:qo,fetch:Yo};b.forEach(dn,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const gs=t=>`- ${t}`,Vo=t=>b.isFunction(t)||t===null||t===!1,ur={getAdapter:t=>{t=b.isArray(t)?t:[t];const{length:e}=t;let n,s;const r={};for(let i=0;i<e;i++){n=t[i];let o;if(s=n,!Vo(n)&&(s=dn[(o=String(n)).toLowerCase()],s===void 0))throw new P(`Unknown adapter '${o}'`);if(s)break;r[o||"#"+i]=s}if(!s){const i=Object.entries(r).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(gs).join(`
`):" "+gs(i[0]):"as no adapter specified";throw new P("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:dn};function Kt(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ze(null,t)}function bs(t){return Kt(t),t.headers=fe.from(t.headers),t.data=Qt.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),ur.getAdapter(t.adapter||vn.adapter)(t).then(function(s){return Kt(t),s.data=Qt.call(t,t.transformResponse,s),s.headers=fe.from(s.headers),s},function(s){return rr(s)||(Kt(t),s&&s.response&&(s.response.data=Qt.call(t,t.transformResponse,s.response),s.response.headers=fe.from(s.response.headers))),Promise.reject(s)})}const dr="1.7.9",It={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{It[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const ys={};It.transitional=function(e,n,s){function r(i,o){return"[Axios v"+dr+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,a)=>{if(e===!1)throw new P(r(o," has been removed"+(n?" in "+n:"")),P.ERR_DEPRECATED);return n&&!ys[o]&&(ys[o]=!0,console.warn(r(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,o,a):!0}};It.spelling=function(e){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function Xo(t,e,n){if(typeof t!="object")throw new P("options must be an object",P.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let r=s.length;for(;r-- >0;){const i=s[r],o=e[i];if(o){const a=t[i],l=a===void 0||o(a,i,t);if(l!==!0)throw new P("option "+i+" must be "+l,P.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new P("Unknown option "+i,P.ERR_BAD_OPTION)}}const xt={assertOptions:Xo,validators:It},be=xt.validators;class At{constructor(e){this.defaults=e,this.interceptors={request:new cs,response:new cs}}async request(e,n){try{return await this._request(e,n)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Le(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:i}=n;s!==void 0&&xt.assertOptions(s,{silentJSONParsing:be.transitional(be.boolean),forcedJSONParsing:be.transitional(be.boolean),clarifyTimeoutError:be.transitional(be.boolean)},!1),r!=null&&(b.isFunction(r)?n.paramsSerializer={serialize:r}:xt.assertOptions(r,{encode:be.function,serialize:be.function},!0)),xt.assertOptions(n,{baseUrl:be.spelling("baseURL"),withXsrfToken:be.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&b.merge(i.common,i[n.method]);i&&b.forEach(["delete","get","head","post","put","patch","common"],m=>{delete i[m]}),n.headers=fe.concat(o,i);const a=[];let l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(n)===!1||(l=l&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});const c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let u,f=0,p;if(!l){const m=[bs.bind(this),void 0];for(m.unshift.apply(m,a),m.push.apply(m,c),p=m.length,u=Promise.resolve(n);f<p;)u=u.then(m[f++],m[f++]);return u}p=a.length;let h=n;for(f=0;f<p;){const m=a[f++],g=a[f++];try{h=m(h)}catch(y){g.call(this,y);break}}try{u=bs.call(this,h)}catch(m){return Promise.reject(m)}for(f=0,p=c.length;f<p;)u=u.then(c[f++],c[f++]);return u}getUri(e){e=Le(this.defaults,e);const n=or(e.baseURL,e.url);return tr(n,e.params,e.paramsSerializer)}}b.forEach(["delete","get","head","options"],function(e){At.prototype[e]=function(n,s){return this.request(Le(s||{},{method:e,url:n,data:(s||{}).data}))}});b.forEach(["post","put","patch"],function(e){function n(s){return function(i,o,a){return this.request(Le(a||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}At.prototype[e]=n(),At.prototype[e+"Form"]=n(!0)});const wt=At;class kn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(r=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](r);s._listeners=null}),this.promise.then=r=>{let i;const o=new Promise(a=>{s.subscribe(a),i=a}).then(r);return o.cancel=function(){s.unsubscribe(i)},o},e(function(i,o,a){s.reason||(s.reason=new ze(i,o,a),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=s=>{e.abort(s)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new kn(function(r){e=r}),cancel:e}}}const Jo=kn;function Qo(t){return function(n){return t.apply(null,n)}}function Ko(t){return b.isObject(t)&&t.isAxiosError===!0}const fn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(fn).forEach(([t,e])=>{fn[e]=t});const Zo=fn;function fr(t){const e=new wt(t),n=zs(wt.prototype.request,e);return b.extend(n,wt.prototype,e,{allOwnKeys:!0}),b.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return fr(Le(t,r))},n}const V=fr(vn);V.Axios=wt;V.CanceledError=ze;V.CancelToken=Jo;V.isCancel=rr;V.VERSION=dr;V.toFormData=Lt;V.AxiosError=P;V.Cancel=V.CanceledError;V.all=function(e){return Promise.all(e)};V.spread=Qo;V.isAxiosError=Ko;V.mergeConfig=Le;V.AxiosHeaders=fe;V.formToJSON=t=>sr(b.isHTMLForm(t)?new FormData(t):t);V.getAdapter=ur.getAdapter;V.HttpStatusCode=Zo;V.default=V;const Ru=V,ea=new Set(["ENOTFOUND","ENETUNREACH","UNABLE_TO_GET_ISSUER_CERT","UNABLE_TO_GET_CRL","UNABLE_TO_DECRYPT_CERT_SIGNATURE","UNABLE_TO_DECRYPT_CRL_SIGNATURE","UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY","CERT_SIGNATURE_FAILURE","CRL_SIGNATURE_FAILURE","CERT_NOT_YET_VALID","CERT_HAS_EXPIRED","CRL_NOT_YET_VALID","CRL_HAS_EXPIRED","ERROR_IN_CERT_NOT_BEFORE_FIELD","ERROR_IN_CERT_NOT_AFTER_FIELD","ERROR_IN_CRL_LAST_UPDATE_FIELD","ERROR_IN_CRL_NEXT_UPDATE_FIELD","OUT_OF_MEM","DEPTH_ZERO_SELF_SIGNED_CERT","SELF_SIGNED_CERT_IN_CHAIN","UNABLE_TO_GET_ISSUER_CERT_LOCALLY","UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_CHAIN_TOO_LONG","CERT_REVOKED","INVALID_CA","PATH_LENGTH_EXCEEDED","INVALID_PURPOSE","CERT_UNTRUSTED","CERT_REJECTED","HOSTNAME_MISMATCH"]);var ta=t=>!ea.has(t&&t.code);function _s(t,e,n,s,r,i,o){try{var a=t[i](o),l=a.value}catch(c){n(c);return}a.done?e(l):Promise.resolve(l).then(s,r)}function pr(t){return function(){var e=this,n=arguments;return new Promise(function(s,r){var i=t.apply(e,n);function o(l){_s(i,s,r,o,a,"next",l)}function a(l){_s(i,s,r,o,a,"throw",l)}o(void 0)})}}function xs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Zt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xs(Object(n),!0).forEach(function(s){na(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xs(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function na(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var mr="axios-retry";function hr(t){var e=["ERR_CANCELED","ECONNABORTED"];return!t.response&&Boolean(t.code)&&!e.includes(t.code)&&ta(t)}var gr=["get","head","options"],sa=gr.concat(["put","delete"]);function Tn(t){return t.code!=="ECONNABORTED"&&(!t.response||t.response.status>=500&&t.response.status<=599)}function ra(t){return t.config?Tn(t)&&gr.indexOf(t.config.method)!==-1:!1}function br(t){return t.config?Tn(t)&&sa.indexOf(t.config.method)!==-1:!1}function yr(t){return hr(t)||br(t)}function ia(){return 0}function oa(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:100,n=Math.pow(2,t)*e,s=n*.2*Math.random();return n+s}var aa={retries:3,retryCondition:yr,retryDelay:ia,shouldResetTimeout:!1,onRetry:()=>{}};function la(t,e){return Zt(Zt(Zt({},aa),e),t[mr])}function ws(t,e){var n=la(t,e);return n.retryCount=n.retryCount||0,t[mr]=n,n}function ca(t,e){t.defaults.agent===e.agent&&delete e.agent,t.defaults.httpAgent===e.httpAgent&&delete e.httpAgent,t.defaults.httpsAgent===e.httpsAgent&&delete e.httpsAgent}function ua(t,e){return pn.apply(this,arguments)}function pn(){return pn=pr(function*(t,e){var{retries:n,retryCondition:s}=t,r=t.retryCount<n&&s(e);if(typeof r=="object")try{var i=yield r;return i!==!1}catch{return!1}return r}),pn.apply(this,arguments)}function je(t,e){var n=t.interceptors.request.use(r=>{var i=ws(r,e);return i.lastRequestTime=Date.now(),r}),s=t.interceptors.response.use(null,function(){var r=pr(function*(i){var{config:o}=i;if(!o)return Promise.reject(i);var a=ws(o,e);if(yield ua(a,i)){a.retryCount+=1;var{retryDelay:l,shouldResetTimeout:c,onRetry:u}=a,f=l(a.retryCount,i);if(ca(t,o),!c&&o.timeout&&a.lastRequestTime){var p=Date.now()-a.lastRequestTime,h=o.timeout-p-f;if(h<=0)return Promise.reject(i);o.timeout=h}return o.transformRequest=[m=>m],yield u(a.retryCount,i,o),new Promise(m=>setTimeout(()=>m(t(o)),f))}return Promise.reject(i)});return function(i){return r.apply(this,arguments)}}());return{requestInterceptorId:n,responseInterceptorId:s}}je.isNetworkError=hr;je.isSafeRequestError=ra;je.isIdempotentRequestError=br;je.isNetworkOrIdempotentRequestError=yr;je.exponentialDelay=oa;je.isRetryableError=Tn;/*! @license DOMPurify 3.2.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.3/LICENSE */const{entries:_r,setPrototypeOf:Ss,isFrozen:da,getPrototypeOf:fa,getOwnPropertyDescriptor:pa}=Object;let{freeze:re,seal:ue,create:xr}=Object,{apply:mn,construct:hn}=typeof Reflect<"u"&&Reflect;re||(re=function(e){return e});ue||(ue=function(e){return e});mn||(mn=function(e,n,s){return e.apply(n,s)});hn||(hn=function(e,n){return new e(...n)});const gt=le(Array.prototype.forEach),vs=le(Array.prototype.pop),Je=le(Array.prototype.push),St=le(String.prototype.toLowerCase),en=le(String.prototype.toString),ks=le(String.prototype.match),Qe=le(String.prototype.replace),ma=le(String.prototype.indexOf),ha=le(String.prototype.trim),de=le(Object.prototype.hasOwnProperty),ne=le(RegExp.prototype.test),Ke=ga(TypeError);function le(t){return function(e){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];return mn(t,e,s)}}function ga(t){return function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return hn(t,n)}}function I(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:St;Ss&&Ss(t,null);let s=e.length;for(;s--;){let r=e[s];if(typeof r=="string"){const i=n(r);i!==r&&(da(e)||(e[s]=i),r=i)}t[r]=!0}return t}function ba(t){for(let e=0;e<t.length;e++)de(t,e)||(t[e]=null);return t}function Re(t){const e=xr(null);for(const[n,s]of _r(t))de(t,n)&&(Array.isArray(s)?e[n]=ba(s):s&&typeof s=="object"&&s.constructor===Object?e[n]=Re(s):e[n]=s);return e}function Ze(t,e){for(;t!==null;){const s=pa(t,e);if(s){if(s.get)return le(s.get);if(typeof s.value=="function")return le(s.value)}t=fa(t)}function n(){return null}return n}const Ts=re(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),tn=re(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),nn=re(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ya=re(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),sn=re(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),_a=re(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Es=re(["#text"]),As=re(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),rn=re(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Os=re(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),bt=re(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),xa=ue(/\{\{[\w\W]*|[\w\W]*\}\}/gm),wa=ue(/<%[\w\W]*|[\w\W]*%>/gm),Sa=ue(/\$\{[\w\W]*}/gm),va=ue(/^data-[\-\w.\u00B7-\uFFFF]+$/),ka=ue(/^aria-[\-\w]+$/),wr=ue(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ta=ue(/^(?:\w+script|data):/i),Ea=ue(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Sr=ue(/^html$/i),Aa=ue(/^[a-z][.\w]*(-[.\w]+)+$/i);var Rs=Object.freeze({__proto__:null,ARIA_ATTR:ka,ATTR_WHITESPACE:Ea,CUSTOM_ELEMENT:Aa,DATA_ATTR:va,DOCTYPE_NAME:Sr,ERB_EXPR:wa,IS_ALLOWED_URI:wr,IS_SCRIPT_OR_DATA:Ta,MUSTACHE_EXPR:xa,TMPLIT_EXPR:Sa});const et={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},Oa=function(){return typeof window>"u"?null:window},Ra=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let s=null;const r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(s=n.getAttribute(r));const i="dompurify"+(s?"#"+s:"");try{return e.createPolicy(i,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},Ds=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function vr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Oa();const e=A=>vr(A);if(e.version="3.2.3",e.removed=[],!t||!t.document||t.document.nodeType!==et.document)return e.isSupported=!1,e;let{document:n}=t;const s=n,r=s.currentScript,{DocumentFragment:i,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:f,DOMParser:p,trustedTypes:h}=t,m=l.prototype,g=Ze(m,"cloneNode"),y=Ze(m,"remove"),v=Ze(m,"nextSibling"),T=Ze(m,"childNodes"),O=Ze(m,"parentNode");if(typeof o=="function"){const A=n.createElement("template");A.content&&A.content.ownerDocument&&(n=A.content.ownerDocument)}let w,E="";const{implementation:N,createNodeIterator:U,createDocumentFragment:j,getElementsByTagName:R}=n,{importNode:C}=s;let B=Ds();e.isSupported=typeof _r=="function"&&typeof O=="function"&&N&&N.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:q,ERB_EXPR:G,TMPLIT_EXPR:me,DATA_ATTR:at,ARIA_ATTR:lt,IS_SCRIPT_OR_DATA:Rr,ATTR_WHITESPACE:Rn,CUSTOM_ELEMENT:Dr}=Rs;let{IS_ALLOWED_URI:Dn}=Rs,X=null;const Pn=I({},[...Ts,...tn,...nn,...sn,...Es]);let Q=null;const Cn=I({},[...As,...rn,...Os,...bt]);let Y=Object.seal(xr(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),We=null,Ft=null,Ln=!0,$t=!0,Nn=!1,Mn=!0,Ne=!1,Bt=!0,Ae=!1,Ut=!1,Ht=!1,Me=!1,ct=!1,ut=!1,In=!0,qn=!1;const Pr="user-content-";let zt=!0,Ge=!1,Ie={},qe=null;const Fn=I({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let $n=null;const Bn=I({},["audio","video","img","source","image","track"]);let jt=null;const Un=I({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),dt="http://www.w3.org/1998/Math/MathML",ft="http://www.w3.org/2000/svg",we="http://www.w3.org/1999/xhtml";let Fe=we,Wt=!1,Gt=null;const Cr=I({},[dt,ft,we],en);let pt=I({},["mi","mo","mn","ms","mtext"]),mt=I({},["annotation-xml"]);const Lr=I({},["title","style","font","a","script"]);let Ye=null;const Nr=["application/xhtml+xml","text/html"],Mr="text/html";let J=null,$e=null;const Ir=n.createElement("form"),Hn=function(d){return d instanceof RegExp||d instanceof Function},Yt=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!($e&&$e===d)){if((!d||typeof d!="object")&&(d={}),d=Re(d),Ye=Nr.indexOf(d.PARSER_MEDIA_TYPE)===-1?Mr:d.PARSER_MEDIA_TYPE,J=Ye==="application/xhtml+xml"?en:St,X=de(d,"ALLOWED_TAGS")?I({},d.ALLOWED_TAGS,J):Pn,Q=de(d,"ALLOWED_ATTR")?I({},d.ALLOWED_ATTR,J):Cn,Gt=de(d,"ALLOWED_NAMESPACES")?I({},d.ALLOWED_NAMESPACES,en):Cr,jt=de(d,"ADD_URI_SAFE_ATTR")?I(Re(Un),d.ADD_URI_SAFE_ATTR,J):Un,$n=de(d,"ADD_DATA_URI_TAGS")?I(Re(Bn),d.ADD_DATA_URI_TAGS,J):Bn,qe=de(d,"FORBID_CONTENTS")?I({},d.FORBID_CONTENTS,J):Fn,We=de(d,"FORBID_TAGS")?I({},d.FORBID_TAGS,J):{},Ft=de(d,"FORBID_ATTR")?I({},d.FORBID_ATTR,J):{},Ie=de(d,"USE_PROFILES")?d.USE_PROFILES:!1,Ln=d.ALLOW_ARIA_ATTR!==!1,$t=d.ALLOW_DATA_ATTR!==!1,Nn=d.ALLOW_UNKNOWN_PROTOCOLS||!1,Mn=d.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ne=d.SAFE_FOR_TEMPLATES||!1,Bt=d.SAFE_FOR_XML!==!1,Ae=d.WHOLE_DOCUMENT||!1,Me=d.RETURN_DOM||!1,ct=d.RETURN_DOM_FRAGMENT||!1,ut=d.RETURN_TRUSTED_TYPE||!1,Ht=d.FORCE_BODY||!1,In=d.SANITIZE_DOM!==!1,qn=d.SANITIZE_NAMED_PROPS||!1,zt=d.KEEP_CONTENT!==!1,Ge=d.IN_PLACE||!1,Dn=d.ALLOWED_URI_REGEXP||wr,Fe=d.NAMESPACE||we,pt=d.MATHML_TEXT_INTEGRATION_POINTS||pt,mt=d.HTML_INTEGRATION_POINTS||mt,Y=d.CUSTOM_ELEMENT_HANDLING||{},d.CUSTOM_ELEMENT_HANDLING&&Hn(d.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Y.tagNameCheck=d.CUSTOM_ELEMENT_HANDLING.tagNameCheck),d.CUSTOM_ELEMENT_HANDLING&&Hn(d.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Y.attributeNameCheck=d.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),d.CUSTOM_ELEMENT_HANDLING&&typeof d.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Y.allowCustomizedBuiltInElements=d.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ne&&($t=!1),ct&&(Me=!0),Ie&&(X=I({},Es),Q=[],Ie.html===!0&&(I(X,Ts),I(Q,As)),Ie.svg===!0&&(I(X,tn),I(Q,rn),I(Q,bt)),Ie.svgFilters===!0&&(I(X,nn),I(Q,rn),I(Q,bt)),Ie.mathMl===!0&&(I(X,sn),I(Q,Os),I(Q,bt))),d.ADD_TAGS&&(X===Pn&&(X=Re(X)),I(X,d.ADD_TAGS,J)),d.ADD_ATTR&&(Q===Cn&&(Q=Re(Q)),I(Q,d.ADD_ATTR,J)),d.ADD_URI_SAFE_ATTR&&I(jt,d.ADD_URI_SAFE_ATTR,J),d.FORBID_CONTENTS&&(qe===Fn&&(qe=Re(qe)),I(qe,d.FORBID_CONTENTS,J)),zt&&(X["#text"]=!0),Ae&&I(X,["html","head","body"]),X.table&&(I(X,["tbody"]),delete We.tbody),d.TRUSTED_TYPES_POLICY){if(typeof d.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ke('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof d.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ke('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=d.TRUSTED_TYPES_POLICY,E=w.createHTML("")}else w===void 0&&(w=Ra(h,r)),w!==null&&typeof E=="string"&&(E=w.createHTML(""));re&&re(d),$e=d}},zn=I({},[...tn,...nn,...ya]),jn=I({},[...sn,..._a]),qr=function(d){let x=O(d);(!x||!x.tagName)&&(x={namespaceURI:Fe,tagName:"template"});const k=St(d.tagName),W=St(x.tagName);return Gt[d.namespaceURI]?d.namespaceURI===ft?x.namespaceURI===we?k==="svg":x.namespaceURI===dt?k==="svg"&&(W==="annotation-xml"||pt[W]):Boolean(zn[k]):d.namespaceURI===dt?x.namespaceURI===we?k==="math":x.namespaceURI===ft?k==="math"&&mt[W]:Boolean(jn[k]):d.namespaceURI===we?x.namespaceURI===ft&&!mt[W]||x.namespaceURI===dt&&!pt[W]?!1:!jn[k]&&(Lr[k]||!zn[k]):!!(Ye==="application/xhtml+xml"&&Gt[d.namespaceURI]):!1},he=function(d){Je(e.removed,{element:d});try{O(d).removeChild(d)}catch{y(d)}},ht=function(d,x){try{Je(e.removed,{attribute:x.getAttributeNode(d),from:x})}catch{Je(e.removed,{attribute:null,from:x})}if(x.removeAttribute(d),d==="is")if(Me||ct)try{he(x)}catch{}else try{x.setAttribute(d,"")}catch{}},Wn=function(d){let x=null,k=null;if(Ht)d="<remove></remove>"+d;else{const K=ks(d,/^[\r\n\t ]+/);k=K&&K[0]}Ye==="application/xhtml+xml"&&Fe===we&&(d='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+d+"</body></html>");const W=w?w.createHTML(d):d;if(Fe===we)try{x=new p().parseFromString(W,Ye)}catch{}if(!x||!x.documentElement){x=N.createDocument(Fe,"template",null);try{x.documentElement.innerHTML=Wt?E:W}catch{}}const Z=x.body||x.documentElement;return d&&k&&Z.insertBefore(n.createTextNode(k),Z.childNodes[0]||null),Fe===we?R.call(x,Ae?"html":"body")[0]:Ae?x.documentElement:Z},Gn=function(d){return U.call(d.ownerDocument||d,d,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Vt=function(d){return d instanceof f&&(typeof d.nodeName!="string"||typeof d.textContent!="string"||typeof d.removeChild!="function"||!(d.attributes instanceof u)||typeof d.removeAttribute!="function"||typeof d.setAttribute!="function"||typeof d.namespaceURI!="string"||typeof d.insertBefore!="function"||typeof d.hasChildNodes!="function")},Yn=function(d){return typeof a=="function"&&d instanceof a};function Se(A,d,x){gt(A,k=>{k.call(e,d,x,$e)})}const Vn=function(d){let x=null;if(Se(B.beforeSanitizeElements,d,null),Vt(d))return he(d),!0;const k=J(d.nodeName);if(Se(B.uponSanitizeElement,d,{tagName:k,allowedTags:X}),d.hasChildNodes()&&!Yn(d.firstElementChild)&&ne(/<[/\w]/g,d.innerHTML)&&ne(/<[/\w]/g,d.textContent)||d.nodeType===et.progressingInstruction||Bt&&d.nodeType===et.comment&&ne(/<[/\w]/g,d.data))return he(d),!0;if(!X[k]||We[k]){if(!We[k]&&Jn(k)&&(Y.tagNameCheck instanceof RegExp&&ne(Y.tagNameCheck,k)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(k)))return!1;if(zt&&!qe[k]){const W=O(d)||d.parentNode,Z=T(d)||d.childNodes;if(Z&&W){const K=Z.length;for(let ie=K-1;ie>=0;--ie){const ge=g(Z[ie],!0);ge.__removalCount=(d.__removalCount||0)+1,W.insertBefore(ge,v(d))}}}return he(d),!0}return d instanceof l&&!qr(d)||(k==="noscript"||k==="noembed"||k==="noframes")&&ne(/<\/no(script|embed|frames)/i,d.innerHTML)?(he(d),!0):(Ne&&d.nodeType===et.text&&(x=d.textContent,gt([q,G,me],W=>{x=Qe(x,W," ")}),d.textContent!==x&&(Je(e.removed,{element:d.cloneNode()}),d.textContent=x)),Se(B.afterSanitizeElements,d,null),!1)},Xn=function(d,x,k){if(In&&(x==="id"||x==="name")&&(k in n||k in Ir))return!1;if(!($t&&!Ft[x]&&ne(at,x))){if(!(Ln&&ne(lt,x))){if(!Q[x]||Ft[x]){if(!(Jn(d)&&(Y.tagNameCheck instanceof RegExp&&ne(Y.tagNameCheck,d)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(d))&&(Y.attributeNameCheck instanceof RegExp&&ne(Y.attributeNameCheck,x)||Y.attributeNameCheck instanceof Function&&Y.attributeNameCheck(x))||x==="is"&&Y.allowCustomizedBuiltInElements&&(Y.tagNameCheck instanceof RegExp&&ne(Y.tagNameCheck,k)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(k))))return!1}else if(!jt[x]){if(!ne(Dn,Qe(k,Rn,""))){if(!((x==="src"||x==="xlink:href"||x==="href")&&d!=="script"&&ma(k,"data:")===0&&$n[d])){if(!(Nn&&!ne(Rr,Qe(k,Rn,"")))){if(k)return!1}}}}}}return!0},Jn=function(d){return d!=="annotation-xml"&&ks(d,Dr)},Qn=function(d){Se(B.beforeSanitizeAttributes,d,null);const{attributes:x}=d;if(!x||Vt(d))return;const k={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Q,forceKeepAttr:void 0};let W=x.length;for(;W--;){const Z=x[W],{name:K,namespaceURI:ie,value:ge}=Z,Ve=J(K);let te=K==="value"?ge:ha(ge);if(k.attrName=Ve,k.attrValue=te,k.keepAttr=!0,k.forceKeepAttr=void 0,Se(B.uponSanitizeAttribute,d,k),te=k.attrValue,qn&&(Ve==="id"||Ve==="name")&&(ht(K,d),te=Pr+te),Bt&&ne(/((--!?|])>)|<\/(style|title)/i,te)){ht(K,d);continue}if(k.forceKeepAttr||(ht(K,d),!k.keepAttr))continue;if(!Mn&&ne(/\/>/i,te)){ht(K,d);continue}Ne&&gt([q,G,me],Zn=>{te=Qe(te,Zn," ")});const Kn=J(d.nodeName);if(!!Xn(Kn,Ve,te)){if(w&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!ie)switch(h.getAttributeType(Kn,Ve)){case"TrustedHTML":{te=w.createHTML(te);break}case"TrustedScriptURL":{te=w.createScriptURL(te);break}}try{ie?d.setAttributeNS(ie,K,te):d.setAttribute(K,te),Vt(d)?he(d):vs(e.removed)}catch{}}}Se(B.afterSanitizeAttributes,d,null)},Fr=function A(d){let x=null;const k=Gn(d);for(Se(B.beforeSanitizeShadowDOM,d,null);x=k.nextNode();)Se(B.uponSanitizeShadowNode,x,null),Vn(x),Qn(x),x.content instanceof i&&A(x.content);Se(B.afterSanitizeShadowDOM,d,null)};return e.sanitize=function(A){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=null,k=null,W=null,Z=null;if(Wt=!A,Wt&&(A="<!-->"),typeof A!="string"&&!Yn(A))if(typeof A.toString=="function"){if(A=A.toString(),typeof A!="string")throw Ke("dirty is not a string, aborting")}else throw Ke("toString is not a function");if(!e.isSupported)return A;if(Ut||Yt(d),e.removed=[],typeof A=="string"&&(Ge=!1),Ge){if(A.nodeName){const ge=J(A.nodeName);if(!X[ge]||We[ge])throw Ke("root node is forbidden and cannot be sanitized in-place")}}else if(A instanceof a)x=Wn("<!---->"),k=x.ownerDocument.importNode(A,!0),k.nodeType===et.element&&k.nodeName==="BODY"||k.nodeName==="HTML"?x=k:x.appendChild(k);else{if(!Me&&!Ne&&!Ae&&A.indexOf("<")===-1)return w&&ut?w.createHTML(A):A;if(x=Wn(A),!x)return Me?null:ut?E:""}x&&Ht&&he(x.firstChild);const K=Gn(Ge?A:x);for(;W=K.nextNode();)Vn(W),Qn(W),W.content instanceof i&&Fr(W.content);if(Ge)return A;if(Me){if(ct)for(Z=j.call(x.ownerDocument);x.firstChild;)Z.appendChild(x.firstChild);else Z=x;return(Q.shadowroot||Q.shadowrootmode)&&(Z=C.call(s,Z,!0)),Z}let ie=Ae?x.outerHTML:x.innerHTML;return Ae&&X["!doctype"]&&x.ownerDocument&&x.ownerDocument.doctype&&x.ownerDocument.doctype.name&&ne(Sr,x.ownerDocument.doctype.name)&&(ie="<!DOCTYPE "+x.ownerDocument.doctype.name+`>
`+ie),Ne&&gt([q,G,me],ge=>{ie=Qe(ie,ge," ")}),w&&ut?w.createHTML(ie):ie},e.setConfig=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Yt(A),Ut=!0},e.clearConfig=function(){$e=null,Ut=!1},e.isValidAttribute=function(A,d,x){$e||Yt({});const k=J(A),W=J(d);return Xn(k,W,x)},e.addHook=function(A,d){typeof d=="function"&&Je(B[A],d)},e.removeHook=function(A){return vs(B[A])},e.removeHooks=function(A){B[A]=[]},e.removeAllHooks=function(){B=Ds()},e}var Du=vr();function Da(t){return function(...e){var n=e.pop();return t.call(this,e,n)}}var Pa=typeof queueMicrotask=="function"&&queueMicrotask,Ca=typeof setImmediate=="function"&&setImmediate,La=typeof process=="object"&&typeof process.nextTick=="function";function Na(t){setTimeout(t,0)}function Ma(t){return(e,...n)=>t(()=>e(...n))}var tt;Pa?tt=queueMicrotask:Ca?tt=setImmediate:La?tt=process.nextTick:tt=Na;const Ia=Ma(tt);function qa(t){return kr(t)?function(...e){const n=e.pop(),s=t.apply(this,e);return Ps(s,n)}:Da(function(e,n){var s;try{s=t.apply(this,e)}catch(r){return n(r)}if(s&&typeof s.then=="function")return Ps(s,n);n(null,s)})}function Ps(t,e){return t.then(n=>{Cs(e,null,n)},n=>{Cs(e,n&&(n instanceof Error||n.message)?n:new Error(n))})}function Cs(t,e,n){try{t(e,n)}catch(s){Ia(r=>{throw r},s)}}function kr(t){return t[Symbol.toStringTag]==="AsyncFunction"}function Fa(t){return t[Symbol.toStringTag]==="AsyncGenerator"}function $a(t){return typeof t[Symbol.asyncIterator]=="function"}function qt(t){if(typeof t!="function")throw new Error("expected a function");return kr(t)?qa(t):t}function Tr(t,e,n,s){e=e||[];var r=[],i=0,o=qt(n);return t(e,(a,l,c)=>{var u=i++;o(a,(f,p)=>{r[u]=p,c(f)})},a=>{s(a,r)})}function Er(t){return t&&typeof t.length=="number"&&t.length>=0&&t.length%1===0}const Ba={},En=Ba;function An(t){function e(...n){if(t!==null){var s=t;t=null,s.apply(this,n)}}return Object.assign(e,t),e}function Ua(t){return t[Symbol.iterator]&&t[Symbol.iterator]()}function Ha(t){var e=-1,n=t.length;return function(){return++e<n?{value:t[e],key:e}:null}}function za(t){var e=-1;return function(){var s=t.next();return s.done?null:(e++,{value:s.value,key:e})}}function ja(t){var e=t?Object.keys(t):[],n=-1,s=e.length;return function r(){var i=e[++n];return i==="__proto__"?r():n<s?{value:t[i],key:i}:null}}function Wa(t){if(Er(t))return Ha(t);var e=Ua(t);return e?za(e):ja(t)}function On(t){return function(...e){if(t===null)throw new Error("Callback was already called.");var n=t;t=null,n.apply(this,e)}}function Ls(t,e,n,s){let r=!1,i=!1,o=!1,a=0,l=0;function c(){a>=e||o||r||(o=!0,t.next().then(({value:p,done:h})=>{if(!(i||r)){if(o=!1,h){r=!0,a<=0&&s(null);return}a++,n(p,l,u),l++,c()}}).catch(f))}function u(p,h){if(a-=1,!i){if(p)return f(p);if(p===!1){r=!0,i=!0;return}if(h===En||r&&a<=0)return r=!0,s(null);c()}}function f(p){i||(o=!1,r=!0,s(p))}c()}const Ar=t=>(e,n,s)=>{if(s=An(s),t<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return s(null);if(Fa(e))return Ls(e,t,n,s);if($a(e))return Ls(e[Symbol.asyncIterator](),t,n,s);var r=Wa(e),i=!1,o=!1,a=0,l=!1;function c(f,p){if(!o)if(a-=1,f)i=!0,s(f);else if(f===!1)i=!0,o=!0;else{if(p===En||i&&a<=0)return i=!0,s(null);l||u()}}function u(){for(l=!0;a<t&&!i;){var f=r();if(f===null){i=!0,a<=0&&s(null);return}a+=1,n(f.value,f.key,On(c))}l=!1}u()};function ot(t,e){if(e||(e=t.length),!e)throw new Error("arity is undefined");function n(...s){return typeof s[e-1]=="function"?t.apply(this,s):new Promise((r,i)=>{s[e-1]=(o,...a)=>{if(o)return i(o);r(a.length>1?a:a[0])},t.apply(this,s)})}return n}function Ga(t,e,n,s){return Ar(e)(t,qt(n),s)}const Ya=ot(Ga,4);function Va(t,e,n){n=An(n);var s=0,r=0,{length:i}=t,o=!1;i===0&&n(null);function a(l,c){l===!1&&(o=!0),o!==!0&&(l?n(l):(++r===i||c===En)&&n(null))}for(;s<i;s++)e(t[s],s,On(a))}function Xa(t,e,n){return Ya(t,1/0,e,n)}function Ja(t,e,n){var s=Er(t)?Va:Xa;return s(t,qt(e),n)}const Qa=ot(Ja,3);function Ka(t,e,n){return Tr(Qa,t,e,n)}const Pu=ot(Ka,3);function Za(t,e,n,s){return Tr(Ar(e),t,n,s)}const Cu=ot(Za,4);function el(t,e){if(e=An(e),!Array.isArray(t))return e(new Error("First argument to waterfall must be an array of functions"));if(!t.length)return e();var n=0;function s(i){var o=qt(t[n++]);o(...i,On(r))}function r(i,...o){if(i!==!1){if(i||n===t.length)return e(i,...o);s(o)}}s([])}const Lu=ot(el),tl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function nl(t,e){return D(),L("svg",tl,e[0]||(e[0]=[S("g",{fill:"none",stroke:"currentColor","stroke-width":"2"},[S("path",{d:"M21 12a9 9 0 1 1-18 0a9 9 0 0 1 18 0Z"}),S("path",{"stroke-linecap":"round",d:"m9 15l6-6m0 6L9 9"})],-1)]))}const sl=xe({name:"humbleicons-times-circle",render:nl});const rl={name:"overlay",data(){return{showLogo:!1,imageSources:{logo:chrome.runtime.getURL("assets/images/audible-library-extractor-logo.svg")}}},mounted:function(){this.showLogo=!0,document.querySelector("html").classList.add("ale-overlay-open")},methods:{closeOverlay:function(){window.location.reload()}}},il={id:"audible-library-extractor"},ol={class:"inner-wrap"},al=["src"];function ll(t,e,n,s,r,i){const o=sl;return D(),L("div",il,[S("div",ol,[S("div",{class:"close-btn",onClick:e[0]||(e[0]=a=>i.closeOverlay())},[ce(o)]),S("div",{id:"the-adbl-logo",class:_e({"fade-in-fwd":r.showLogo})},[S("img",{src:r.imageSources.logo,alt:""},null,8,al)],2),zr(t.$slots,"default")])])}const cl=Te(rl,[["render",ll]]);const ul={name:"scrapingProgress",props:["domainExtension"],data(){return{store:this.$store.state,imageSources:{logo:chrome.runtime.getURL("assets/images/audible-library-extractor-logo.svg"),loader:chrome.runtime.getURL("assets/images/loader-64px.gif")}}},computed:{steps:function(){return this.store.progress.step>0?this.store.progress.step+" / "+this.store.progress.max:this.store.progress.max},bigSteps:function(){return this.store.bigStep.step>0?this.store.bigStep.step+" / "+this.store.bigStep.max:this.store.bigStep.max},subSteps:function(){return this.store.subStep.step>0?this.store.subStep.step+" / "+this.store.subStep.max:this.store.subStep.max},progressWidth:function(){return{width:this.store.progress.step/this.store.progress.max*100+"%"}}},methods:{wishlistLinkClicked(t){this.$store.commit("update",{key:"sticky.openOnLoad",value:!0}),chrome.runtime.sendMessage({action:"refresh",url:window.location.origin+window.location.pathname}),chrome.runtime.sendMessage({action:"newPage",url:t.target.href})}}},dl={key:0},fl={key:1},pl={class:"message is-warning wishlist-login-wrapper"},ml={class:"message-body"},hl=["href"],gl={key:2,id:"ale-progress-wrap"},bl={class:"loader-image"},yl=["src"],_l={key:0,class:"step"},xl={class:"ale-progress"},wl={class:"ale-step-text"},Sl={class:"ale-step-additional-info"},vl={style:{"text-align":"center","margin-top":"20px",height:"110px"}},kl=["src"];function Tl(t,e,n,s,r,i){const o=rt("visible");return t.$store.state.checkingWishlistAccess?(D(),L("div",dl,e[1]||(e[1]=[S("div",{class:"progress-wrapper"},[S("progress",{class:"progress is-warning is-large",max:"100",style:{"min-width":"288px"}},"75%"),S("small",{style:{"font-size":"12px"}},"Checking for wishlist access...")],-1)]))):t.$store.state.noWishlistAccess?(D(),L("div",fl,[S("article",pl,[S("div",ml,[e[2]||(e[2]=z(" Try to open your ")),S("a",{onClick:e[0]||(e[0]=jr((...a)=>i.wishlistLinkClicked&&i.wishlistLinkClicked(...a),["prevent"])),target:"_blank",rel:"noopener noreferrer",href:"https://audible"+n.domainExtension+"/wishlist"},"audible"+ye(n.domainExtension)+"/wishlist",9,hl),e[3]||(e[3]=z(" and login when asked. ")),e[4]||(e[4]=S("br",null,null,-1)),e[5]||(e[5]=z(" After that try to redo the extraction. ")),e[6]||(e[6]=S("strong",null,"The link will open in a new tab!",-1))])])])):(D(),L("div",gl,[ce(on,{name:"fade"},{default:vt(()=>[S("div",bl,[S("img",{height:"72",src:r.imageSources.loader,alt:""},null,8,yl)])]),_:1}),r.store.bigStep.title?(D(),L("div",{key:0,class:_e(["ale-big-step",{"sub-step-exists":r.store.subStep.max>0}])},[S("h2",null,[z(ye(r.store.bigStep.title)+"\xA0 ",1),r.store.subStep.max>0?(D(),L("small",_l,"("+ye(i.subSteps)+")",1)):Ce("",!0)])],2)):Ce("",!0),oe((D(),L("div",xl,[S("div",null,[S("div",wl,[oe((D(),L("div",Sl,[z(ye(r.store.progress.text2),1)])),[[o,r.store.progress.text2]]),z(" "+ye(r.store.progress.text)+" ",1),i.steps?(D(),ve(on,{key:0,name:"fade"},{default:vt(()=>[S("span",null,ye(i.steps),1)]),_:1})):Ce("",!0),z(" "+ye(r.store.progress.textsuffix),1)])])])),[[o,r.store.progress.text]]),oe((D(),L("div",{class:_e(["ale-bar",{"scale-in-hor-center":r.store.progress.bar}])},[S("div",{class:"ale-step-line",style:Wr(i.progressWidth)},null,4)],2)),[[o,r.store.progress.bar&&r.store.progress.step&&r.store.progress.max]]),oe(S("div",vl,[S("img",{src:r.store.progress.thumbnail,alt:"",style:{"max-height":"110px"}},null,8,kl)],512),[[yn,r.store.progress.thumbnail]]),e[7]||(e[7]=S("div",{class:"footnote"}," Keep this tab and the browser window on top until the extraction is completed. ",-1))]))}const El=Te(ul,[["render",Tl],["__scopeId","data-v-ab3ad828"]]),Al={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ol(t,e){return D(),L("svg",Al,e[0]||(e[0]=[S("g",{fill:"currentColor"},[S("path",{"fill-rule":"evenodd",d:"M12 19a7 7 0 1 0 0-14a7 7 0 0 0 0 14m0 3c5.523 0 10-4.477 10-10S17.523 2 12 2S2 6.477 2 12s4.477 10 10 10","clip-rule":"evenodd",opacity:".2"}),S("path",{d:"M2 12C2 6.477 6.477 2 12 2v3a7 7 0 0 0-7 7z"})],-1)]))}const Rl=xe({name:"gg-spinner",render:Ol}),Dl={viewBox:"0 0 256 256",width:"1.2em",height:"1.2em"};function Pl(t,e){return D(),L("svg",Dl,e[0]||(e[0]=[S("path",{fill:"currentColor",d:"M71.68 97.22L34.74 128l36.94 30.78a12 12 0 1 1-15.36 18.44l-48-40a12 12 0 0 1 0-18.44l48-40a12 12 0 0 1 15.36 18.44m176 21.56l-48-40a12 12 0 1 0-15.36 18.44L221.26 128l-36.94 30.78a12 12 0 1 0 15.36 18.44l48-40a12 12 0 0 0 0-18.44M164.1 28.72a12 12 0 0 0-15.38 7.18l-64 176a12 12 0 0 0 7.18 15.37a11.8 11.8 0 0 0 4.1.73a12 12 0 0 0 11.28-7.9l64-176a12 12 0 0 0-7.18-15.38"},null,-1)]))}const Cl=xe({name:"ph-code-bold",render:Pl});let M="https://github.com/joonaspaakko/audible-library-extractor/issues/";function F(t,e){return e=e||"Fixed",{text:e+" #"+t,href:M+t}}const Ll={data:function(){return{changeLog:[{version:"v.0.2.12",highlights:"Full extraction recommended in order to extract subcategories.",changes:[{description:"Gallery (mobile): vertical scrolling doesn't always work with book details open.",class:"fixed",link:F(144)},{description:"Fixed publisher subpage in the gallery failing to open if any book is missing publishers.",class:"fixed",link:F(160)},{description:"Fixed randomized thumbnail missing from gallery allery categories page if subcategory is missing from book data.",class:"fixed",link:F(159)},{description:"Added tags to gallery categories page.",class:"fixed",link:F(158)},{description:"Fixed a bug where the sub category was not extracted.",class:"fixed",link:F(157)}]},{version:"v.0.2.11",highlights:"This mostly ended up being a bug fix release. It's recommended to remove all extracted data and do a full extraction after updating to this version. You may want to export raw data beforehand just to be safe.",changes:[{description:'Added new audible domains to the extraction whitelist: ".es" and ".com.br"',class:"added"},{description:"Because of this issue where the extraction was interrupted and you were subsequently banned for the next 10-15 mintues I added a new button in the extraction settings where you may toggle on slow extraction that could help with such issues in the future. I also slowed down series extraction so that the regular (fast) extraction would work better. It might also make sense to try extracting library and wishlist separately.",class:"added",link:F(110)},{description:"The filter list now shows duration in years, months and days. Hovering over it shows what that is in hours. The duration is calculated from book length, which obviously doesn't count for re-listens, and discontinued don't have the data to calculate that.",class:"improved"},{description:"Some fields are no longer being extracted from the website.",class:"fixed",link:F(154)},{description:"Wishlist extraction doesn't work.",class:"fixed",link:F(152)},{description:"No Extraction Button.",class:"fixed",link:F(151)},{description:"Newly added items have no thumbnail when extracted.",class:"fixed",link:F(150)},{description:'Ratings" only captures the first digit.',class:"fixed",link:F(147)},{description:"Wallpaper Creator: star rating flowing into the next row, if cover size is relatively small.",class:"fixed",link:F(145)},{description:"Gallery (mobile): scroll swiping doesn't always work.",class:"fixed",link:F(144)},{description:"Gallery wishlist: pre-order book covers seem to be missing.",class:"fixed",link:F(142)},{description:"Gallery sorting sometimes highlights the wrong item.",class:"fixed",link:F(141)},{description:"Extract user's own written reviews. There's a filter in the gallery for books you've reviewed and theres a button above summary if your review is avaiable for the book in question.",class:"added",link:F(140,"added")},{description:"Wishlist price sorter.",class:"added",link:F(139,"Added")},{description:"New range filter for wishlist price.",class:"added",link:F(138,"Added")},{description:"New filter for wishlist books that are on sale.",class:"added",link:F(137,"Added")},{description:"Number of ratings extracted with faulty data.",class:"fixed",link:F(134)},{description:"Book details: my books in the series list's owned counter counts wishlist books as owned.",class:"fixed",link:F(131)}]},{version:"v.0.2.10",highlights:"",changes:[{description:"Search bar total books tooltip: added total listening time for the books in the selection.",class:"added"},{description:"Fixed an issue where collections page was visible in the navigation, even though it was empty.",class:"fixed"},{description:"Fixed an issue that could prevent the series sub page from loading in some cases.",class:"fixed"},{description:`It's not impossible but difficult to navigate back from book details "Links lead to my library" links.`,class:"fixed",link:F(127)},{description:"Clock keeps spinning after all tasks completed.",class:"fixed",link:F(130)}]},{version:"v.0.2.9",highlights:"Full extraction recommended.",changes:[{description:"Gallery book details: at the top right (above the book title) for switching between links leading to audible or the library",class:"improved"},{description:"Better series merging for discontinued books.",class:"improved"},{description:"Gallery: mobile usage has some minor improvements here and there; the mobile menu is a bit cleaner, you can copy a link to the current page in even if it's saved to your phone's home screen, which is when there's no addressbar or anything to copy it normally.",class:"improved"},{description:`Wallpaper creator: a new "tier list" mode and a clearer preset selector that shows up every time it's opened.`,class:"added"},{description:"Gallery: collections now have some premade collections.",class:"improved"},{description:`Gallery: as of this version, the special "standalone gallery" cannot be viewed locally due to the build tool changes. This changes nothing for the extension gallery and you can still upload it to github or your own web server and it's work just as before.`,class:"removed"},{description:"Extraction provess: books will now be saved after extracting every book in the library or the wishlist. Also wishlist extraction happens just before wishlist is extracted.",class:"improved"},{description:"Gallery: all the filters with multi-select dropdown lists now have the option to exclude.",class:"added"},{description:"Gallery: the book details sidebar now lists any collections that the book belongs to, if any.",class:"added"},{description:'Gallery: book details carousel now has clickable labels that show you useful info. The labels are: "from this series", "book in library", "series in library", "book in wishlist", and all except the first one open a page of the gallery when clicked.',class:"added"},{description:"Gallery: the tooltip in the book details carousel is now grouped so that you can switch between books faster because you don't have to wait for the tooltip to close and the open for the next one all slowly.",class:"improved"},{description:`Gallery: rating sorts are now visually a bit nicer and also have a backup sort for when multiple books have an equal rating. The very basic logic is that more ratings gives more credibility to the rating, so if you have a "group" of books with the same rating, let's say 4; the first book will have the most ratings and the last book of the group will have the least ratings. Number of ratings sort uses the average rating as the second sort. Also, the area where you see the rating will in some cases contain extra ratings related info when hovered over or clicked on mobile.`,class:"improved"},{description:"All important build tools were updated in this version, which involved breaking changes and involved a lot of revwrites, so keep an eye out for new and old issues.",class:"improved"},{description:"Up to this version the extension used to add global CSS styling that slightly modified the CSS in the library. It added very small unnoticable changes, like shifting text a little bit, but now it's fixed.",class:"fixed"},{description:'Converting progress text from German "Beendet" to English "Finished" ',class:"fixed",link:F(125)},{description:"Series sub page shows false totals.",class:"fixed",link:F(120)},{description:"Missing extraction button on the library page.",class:"fixed",link:F(111)},{description:"Not extracting data for (library): authors, narrators or book numbers.",class:"fixed",link:F(105)},{description:"Extract podcasts too.",class:"fixed",link:F(93)},{description:'Need to login to extract wishlist. After login: "audible redirected you too many times".',class:"fixed",link:F(92)},{description:"Gallery filters: slider not working with other filters.",class:"fixed",link:F(91)},{description:"Wishlist cannot be extracted.",class:"fixed",link:F(90)},{description:"Collections: archived books no longer fetched.",class:"fixed",link:F(89)},{description:'Extractor Freezing on "Fetching series order".',class:"fixed",link:F(87)},{description:"Standalone gallery: saved with collections excluded (occasionally?) loads up blank.",class:"fixed",link:F(81)}]},{version:"v.0.2.8",highlights:`The "Audible Library Extractor" button in Audible's website now looks like a button and was moved above the search input, because Audible continually made small changes and it could no longer fit where it used to be.`,changes:[{description:"Extraction comes up with 20 books (single page). Note: audible changed things",class:"fixed",link:{text:"Fixed #72",href:M+"72"}},{description:"Wishlist extraction discards all data and the wishlist gallery page comes up empty. Note: audible changed things",class:"fixed",link:{text:"Fixed #71",href:M+"71"}},{description:"Wallpaper creator showing a blank page (if used hadn't extracted collections).",class:"fixed",link:{text:"Fixed #69",href:M+"69"}},{description:'Some "unavailable" books not marked properly. Note: this bug was introduced in v.0.2.7',class:"fixed",link:{text:"Fixed #68",href:M+"68"}},{description:"Top menu disappears sometimes on certain pages bug",class:"fixed",link:{text:"Fixed #67",href:M+"67"}}]},{version:"v.0.2.7",highlights:`
            You should do a full extraction after updating to this version. There are a a few new data points that the partial extraction will not update to any old books.
            <br><br>
            I added global context menu items so you can easily open the gallery by right-clicking anywhere inside any tab and choose "Audible Library Extracor > Gallery page".
            <br><br>
            There's now a wallpaper creator in the extension gallery. Look for it in the top menu.
          `,changes:[{description:"Added import and export for raw data. Data is stored in your browser, but if you for example get a new computer you could export data on your current computer and import it on the new one and you don't have to do a full extraction.",class:"added"},{description:"Added dropdown list type filters, which allow you to filter books by properties like the language or format etc...",class:"added"},{description:"You can now collapse & expand book cover and information in the book details view.",class:"improved"},{description:`"My books in the library" list now shows you if any books you don't own are available in the Plus Catalog. Also you can now open book links to a new tab, which wasn't possible before. `,class:"improved"},{description:"Added genre / theme tags. These are little pill shaped text btns you see below the summary on some store pages.",class:"added"},{description:"Added better Archive handling. Filters and sorting for archived books. Standalone gallery now has an option to exclude archived books / archived collection.",class:"added"},{description:"Added whispersync data: 1. Color dot on the covers if you own the Kindle version. 2. Whispersync filters 3. Whispersync sorters 4. Whispersync label inside the book details view",class:"added"},{link:{text:"Fixed #66",href:M+"66"},description:"Extraction can not complete: Cannot read properties of null (reading 'getAttribute').",class:"fixed"},{link:{text:"Added #62",href:M+"62"},description:"Image editor (wallpaper generator).",class:"added"},{link:{text:"Fixed #60",href:M+"60"},description:'"Audible Library Extractor" text button is cut off in Audible library page.',class:"fixed"},{link:{text:"Fixed #56",href:M+"56"},description:"Wishlist extraction stops right when it's about to start.",class:"fixed"},{link:{text:"Fixed #54",href:M+"54"},description:"Partial library update doesn't merge old series data with new series data properly.",class:"fixed"},{link:{text:"Fixed #50",href:M+"50"},description:"Collections larger than 20 titles are not getting extracted properly.",class:"fixed"},{link:{text:"Fixed #49",href:M+"49"},description:"Sub pages don't show up in the the stand-alone gallery if you saved it with wishlist and any sub pages while excluding library.",class:"fixed"},{link:{text:"Fixed #48",href:M+"48"},description:"My books in the series list: links lead to empty pages inside the gallery (sometimes). Related to sub page source.",class:"fixed"},{link:{text:"Improved #47",href:M+"47"},description:"Merged the library data update button with the full extraction button. Now wishlist has a partial extraction too!",class:"improved"},{link:{text:"Fixed #46",href:M+"46"},description:"After opening a link to the gallery on a page with book details open, the next chunk of books would not load when scrolling far enough down.",class:"fixed"}]},{version:"v.0.2.6",highlights:"If you want to filter wishlist by Plus Catalog titles, you'll have to extract the <strong>wishlist</strong> again. The 'My books in the series' list can now show all books in the series, but this too requires a full extraction of the <strong>library</strong>. <br><br>Performance improvement <a href='https://github.com/joonaspaakko/audible-library-extractor/issues/41'>#41</a> changes the way the books are loaded in: they are loaded in chunks as you scroll down. This unfortunately makes it so you can't just jump to the beginning of your library at the bottom like you could before. If you must, you can get around this: in the address bar you should see a url parameter like this '?y=347'. The number keeps track of how far you're scrolled. Change that to and obnoxiously high number, like '?y=9999999' and press enter or refresh the page and it will load the entire library at once.",changes:[{link:{text:"New documentation",href:"https://joonaspaakko.gitbook.io/audible-library-extractor/"},description:'<a href="https://joonaspaakko.gitbook.io/audible-library-extractor/" target="_blank" rel="noopener noreferrer">https://joonaspaakko.gitbook.io/audible-library-extractor/</a>',highlight:!0,class:"info"},{link:{text:"Improved #25",href:M+"25"},description:"Improved filters with range sliders and you can enable multiple filters at the same time",highlight:!0,class:"improved"},{link:{text:"Added #30",href:M+"30"},description:"Stand-alone gallery save options that allow you to exclude pages",highlight:!0,class:"added"},{link:{text:"Added #26",href:M+"26"},description:"CSV export (Importable: goodreads, googlesheets, excel, etc...)",highlight:!0,class:"added"},{link:{text:"Fixed #35",href:M+"35"},description:"Firefox: ISBN+Wishlist extraction stops the entire extraction process",highlight:!0,class:"fixed"},{link:{text:"Added #38",href:M+"38"},description:"Easier way to get back to the gallery (and Audible library) using the extension icon context menu",highlight:!0,class:"added"},{link:{text:"Improved #41",href:M+"41"},description:"Improved gallery performance, especially on slightly older mobile devices.",highlight:!0,class:"improved"},{link:{text:"Fixed #44",href:M+"44"},description:"Certain links to Audible not working due to missing encoding",class:"fixed"},{link:{text:"Fixed #43",href:M+"43"},description:"Wishlist series hyperlink doesn't lead anywhere",class:"fixed"},{link:{text:"Fixed #42",href:M+"42"},description:"Child category heading shows up in parent category page",class:"fixed"},{link:{text:"Fixed #40",href:M+"40"},description:"Missing cover images causing various issues in the gallery (mostly affects long time Audible users)",class:"fixed"},{link:{text:"Fixed #37",href:M+"37"},description:"Extension icon active state (color icon) is triggering whenever",class:"fixed"},{link:{text:"Fixed #36",href:M+"36"},description:"Release date sorter not working on mobile (ios)",class:"fixed"},{link:{text:"Fixed #34",href:M+"34"},description:"Wishlist extraction stops and halts the whole extraction part 2",class:"fixed"},{link:{text:"Fixed #33",href:M+"33"},description:"Book details open in the wrong position breaking the grid at certain browser widths",class:"fixed"},{link:{text:"Fixed #31",href:M+"31"},description:"Sorting is taken over by search order If you have an active search and then change filters or search scope",class:"fixed"}]},{version:"v.0.2.5",changes:[{link:{text:"Fixed #28",href:M+"28"},description:"Series/sub page fails to show the right content",class:"fixed"},{link:{text:"Fixed #27",href:M+"27"},description:"The Great Courses (books) omitted",class:"fixed"},{link:{text:"Fixed #24",href:M+"24"},description:"Search overrides sorting URL parameter on page load",class:"fixed"},{link:{text:"Fixed #23",href:M+"23"},description:"Wishlist scraping errored out due to fetching second lvl domain names like \u201C.co.uk\u201D wrong",class:"fixed"},{link:{text:"Fixed #22",href:M+"22"},description:"Categories page empty (sometimes)",class:"fixed"},{link:{text:"Fixed #21",href:M+"21"},description:"View mode button showing up on pages it shouldn\u2019t",class:"fixed"},{link:{text:"Fixed #20",href:M+"20"},description:"Filter and sorter menu disappearing behing the bottom mobile nav",class:"fixed"},{link:{text:"Fixed #19",href:M+"19"},description:"Partial library scan breaking series",class:"fixed"}]},{version:"v.0.2.4",changes:[{description:"First public beta version"}]}]}}};const Nl={mixins:[Ll],data:function(){return{}},methods:{getChangelog:function(){let t="";return _.each(this.changeLog,function(n){t+='<strong style="display: inline-block; width: 100%; font-size: 16px;">'+n.version+"</strong>",t+=n.highlights?'<div style="padding: 6px; margin: 6px 0 7px; color: rgb(128 93 54); background: rgb(246, 153, 50, .06); border: 1px solid rgb(246, 153, 50, .2);">'+n.highlights+"</div>":"",t+='<ul class="ale-changelog-list" style="display: inline-block; width: 100%; box-sizing: border-box;">',_.each(n.changes,function(s){if(s.divider)t+='<li style="height: 0px; border: 1px dashed #f1f1f1; margin: 5px 0; width: 100%;"></li>';else{let r;s.link&&(r=s.highlight?"<strong>"+s.link.text+"</strong>":s.link.text),t+='<li class="'+(s.class||"")+'">'+(s.link?'<a target="_blank" rel="noopener noreferrer" href="'+s.link.href+'">'+r+"</a>: ":"")+(s.description||"")+"</li>"}}),t+="</ul>",t+="<br><br>"}),'<div style="text-align: left; max-height: 350px; overflow: scroll; padding: 20px;">'+t+"</div>"}}},Ml={id:"changelog"},Il=["content"];function ql(t,e,n,s,r,i){const o=Cl,a=rt("tippy");return D(),L("div",Ml,[oe((D(),L("button",{class:"button is-small is-text settings-btn",content:i.getChangelog()},[ce(o,{class:"icon"}),e[0]||(e[0]=S("span",null,"Changelog",-1))],8,Il)),[[a,{allowHTML:!0,trigger:"click",interactive:!0}]])])}const Fl=Te(Nl,[["render",ql],["__scopeId","data-v-26fda39a"]]),$l={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Bl(t,e){return D(),L("svg",$l,e[0]||(e[0]=[S("path",{fill:"currentColor",d:"M10 6v2H5v11h11v-5h2v6a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm11-3v8h-2V6.413l-7.793 7.794l-1.414-1.414L17.585 5H13V3z"},null,-1)]))}const Ul=xe({name:"ri-external-link-line",render:Bl}),Hl={viewBox:"0 0 256 256",width:"1.2em",height:"1.2em"};function zl(t,e){return D(),L("svg",Hl,e[0]||(e[0]=[S("path",{fill:"currentColor",d:"M128 20a108 108 0 1 0 108 108A108.12 108.12 0 0 0 128 20m0 192a84 84 0 1 1 84-84a84.09 84.09 0 0 1-84 84m48.49-92.49a12 12 0 0 1 0 17l-32 32a12 12 0 1 1-17-17L139 140H88a12 12 0 0 1 0-24h51l-11.52-11.51a12 12 0 1 1 17-17Z"},null,-1)]))}const jl=xe({name:"ph-arrow-circle-right-bold",render:zl}),Wl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Gl(t,e){return D(),L("svg",Wl,e[0]||(e[0]=[S("path",{fill:"currentColor",d:"M12 16a3 3 0 0 1-3-3c0-1.12.61-2.1 1.5-2.61l9.71-5.62l-5.53 9.58c-.5.98-1.51 1.65-2.68 1.65m0-13c1.81 0 3.5.5 4.97 1.32l-2.1 1.21C14 5.19 13 5 12 5a8 8 0 0 0-8 8c0 2.21.89 4.21 2.34 5.65h.01c.39.39.39 1.02 0 1.41s-1.03.39-1.42.01A9.97 9.97 0 0 1 2 13A10 10 0 0 1 12 3m10 10c0 2.76-1.12 5.26-2.93 7.07c-.39.38-1.02.38-1.41-.01a.996.996 0 0 1 0-1.41A7.95 7.95 0 0 0 20 13c0-1-.19-2-.54-2.9L20.67 8C21.5 9.5 22 11.18 22 13"},null,-1)]))}const Yl=xe({name:"mdi-speedometer",render:Gl}),Vl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Xl(t,e){return D(),L("svg",Vl,e[0]||(e[0]=[S("path",{fill:"currentColor",d:"M12 16c1.66 0 3-1.34 3-3c0-1.12-.61-2.1-1.5-2.61L3.79 4.77l5.53 9.58c.5.98 1.51 1.65 2.68 1.65m0-13c-1.81 0-3.5.5-4.97 1.32l2.1 1.21C10 5.19 11 5 12 5c4.42 0 8 3.58 8 8c0 2.21-.89 4.21-2.34 5.65h-.01a.996.996 0 0 0 0 1.41c.39.39 1.03.39 1.42.01A9.97 9.97 0 0 0 22 13c0-5.5-4.5-10-10-10M2 13c0 2.76 1.12 5.26 2.93 7.07c.39.38 1.02.38 1.41-.01a.996.996 0 0 0 0-1.41A7.95 7.95 0 0 1 4 13c0-1 .19-2 .54-2.9L3.33 8C2.5 9.5 2 11.18 2 13"},null,-1)]))}const Jl=xe({name:"mdi-speedometer-slow",render:Xl});const Ql={mixins:[bn],data:function(){const t=this,e=this.$store.state;return{store:this.$store.state,exportRawDataDisabled:!1,actions:[{key:"unselect all"},{key:"select all"},{key:"reset new books",disabled:function(){return!e.storageHasData.books},tippy:'<strong>Removes the status &#34;new&#34; from all extracted books.</strong> <br><br>During a partial library or wishlist extraction newly added books are marked and you can filter and sort based on that status in the gallery. <br><br><div style="color: #f14668;">The new status is only ever reset automatically when you clear library data or press this button.</div>'},{key:"export raw data",disabled:function(){return!t.rawDataExport}},{key:"import raw data",inputEvent:!0},{key:"remove all extracted data",extraClasses:"delete-btn"}]}},computed:{rawDataExport(){return!this.exportRawDataDisabled&&this.$store.getters.mainDataExists}},methods:{clickEvent(t,e){const n=_.camelCase(t.key);this[n](e)},unselectAll:function(){const t=this;_.each(this.$store.getters.settings_mainSteps,function(e,n){t.$store.commit("updateSetting",{item:e,obj:{value:!1,disabled:!1}})}),this.$store.commit("update",{key:"extractionButtonDisabled",value:!0})},selectAll:function(){const t=this;_.each(this.$store.getters.settings_mainSteps,function(e){t.$store.commit("updateSetting",{item:e,obj:{value:!0,disabled:e.name==="books"}})}),this.$store.commit("update",{key:"extractionButtonDisabled",value:!1})},resetNewBooks:function(){if(window.confirm("Are you sure you want to clear new book status?")){let e=this,n=function(){e.loading=!1,e.$toast.error({duration:4e3,message:'Failed to remove "new" status from books',type:"is-danger",position:"is-top",closable:!1})};chrome.storage.local.get(null).then(s=>{_.each(_.range(0,s["books-chunk-length"]),function(r){let i=s["books-chunk-"+r];_.each(i,function(o){o.isNew&&delete o.isNew})}),_.each(_.range(0,s["wishlist-chunk-length"]),function(r){let i=s["wishlist-chunk-"+r];_.each(i,function(o){o.isNew&&delete o.isNew})}),chrome.storage.local.clear().then(()=>{chrome.storage.local.set(s).then(()=>{e.$toast.success('All "new" books succesfully reset',e.store.toastOpts)}).catch(n)}).catch(n)}).catch(n)}},exportRawData:function(){let t=this;t.exportRawDataDisabled=!0,chrome.storage.local.get(null).then(e=>{e.chunks&&t.glueFriesBackTogether(e),delete e.imageEditorPageTitle,delete e.imageEditorPageSubTitle,delete e.imageEditorTimeCode,delete e.imageEditorChunksLength,delete e.imageEditorChunks,Vr.exports.saveAs(new Blob([JSON.stringify(e)],{type:"application/json;charset=utf-8"}),"Audible Library Extractor Data.json"),t.exportRawDataDisabled=!1,t.$toast.success("Data exported succesfully!",t.store.toastOpts)}).catch(function(e){t.exportRawDataDisabled=!1,t.$toast.error("Data export failed. Reload the page and try again.",t.store.toastOpts)})},importRawData:function(t){let e=this,n=t.target.files;if(n&&(n=n[0]),t.target.value=null,n){e.loading=!0;let s=function(i){e.loading=!1,e.$toast.error("Data import failed: "+i,e.store.toastOpts)},r=new FileReader;r.onload=function(i){let o=JSON.parse(i.target.result);e.makeFrenchFries(o),chrome.storage.local.clear().then(()=>{chrome.storage.local.set(o).then(function(){chrome.runtime.sendMessage({action:"rebuild-context-menu"}),e.$toast.success("Data imported succesfully!",e.store.toastOpts),e.loading=!1,e.$dataChecker(o)}).catch(s)}).catch(s)},r.onerror=s,r.readAsText(n)}},removeAllExtractedData:function(){let t=this;if(window.confirm("Are you sure you want to remove all extracted data?")){let n=function(s){t.loading=!1,t.$toast.error("Data clear failed: "+s,t.store.toastOpts)};chrome.storage.local.clear().then(function(){chrome.storage.local.get(null).then(s=>{t.$dataChecker(s),chrome.runtime.sendMessage({action:"rebuild-context-menu"}),t.$toast.success("Data removed succesfully",t.store.toastOpts)}).catch(n)}).catch(n)}}}},Kl={class:"description"},Zl={class:"linky-links"},ec=["onClick","content","disabled"],tc=["onChange"],nc={key:0},sc={key:1};function rc(t,e,n,s,r,i){const o=Jl,a=Yl,l=rt("tippy");return D(),L("div",Kl,[S("div",Zl,[S("div",null,[(D(!0),L(Fs,null,$s(t.actions,c=>oe((D(),L("button",{key:c.key,class:_e(["button is-small",c.extraClasses]),onClick:u=>c.inputEvent?null:i.clickEvent(c,u),content:c.tippy,disabled:c.disabled&&c.disabled()},[S("label",null,[z(ye(c.key)+" ",1),c.inputEvent?(D(),L("input",{key:0,accept:".json",type:"file",onChange:u=>i.clickEvent(c,u),style:{display:"none"}},null,40,tc)):Ce("",!0)])],10,ec)),[[l,{maxWidth:400}]])),128)),S("button",{class:"button is-small",onClick:e[0]||(e[0]=c=>t.$store.commit("update",{key:"sticky.slowExtract",value:!t.store.sticky.slowExtract}))},[e[1]||(e[1]=z(" Extract\xA0")),t.store.sticky.slowExtract?(D(),L("span",nc,"slow")):(D(),L("span",sc,"fast")),e[2]||(e[2]=z(" \xA0 ")),t.store.sticky.slowExtract?(D(),ve(o,{key:2,class:"has-text-info"})):(D(),ve(a,{key:3,class:"has-text-danger"}))])])])])}const ic=Te(Ql,[["render",rc],["__scopeId","data-v-2b450519"]]),oc={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function ac(t,e){return D(),L("svg",oc,e[0]||(e[0]=[S("path",{fill:"currentColor",d:"M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1l-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"},null,-1)]))}const lc=xe({name:"bi-trash3",render:ac}),cc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function uc(t,e){return D(),L("svg",cc,e[0]||(e[0]=[S("path",{fill:"currentColor",d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10s10-4.47 10-10S17.53 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8s8 3.58 8 8s-3.58 8-8 8"},null,-1)]))}const dc=xe({name:"ic-outline-circle",render:uc}),fc={viewBox:"0 0 20 20",width:"1.2em",height:"1.2em"};function pc(t,e){return D(),L("svg",fc,e[0]||(e[0]=[S("path",{fill:"currentColor",d:"m0 11l2-2l5 5L18 3l2 2L7 18z"},null,-1)]))}const mc=xe({name:"zondicons-checkmark",render:pc});const hc={props:["index","settings","setting"],data:function(){return{store:this.$store.state}},computed:{settingHasData(){return _.get(this.$store.state.storageHasData,this.setting.name)},settingDisabled(){return this.setting.disabled===!1?null:!0}},methods:{settingChanged:function(){const t=this.setting,e=!t.value,n=this.$store.getters.settings_mainSteps,s=[];if(s.push({item:t,obj:{value:e}}),t.parent){const r=_.find(n,{name:t.parent}),i=_.find(n,function(a){return a.parent===t.parent&&a.value&&a.name!==t.name}),o={disabled:!!(e||i)};o.disabled&&(o.value=!0),s.push({item:r,obj:o})}this.$store.commit("updateSetting",s)},deleteChunkData:function(t,e){let n=this;if(n.loading=!0,t=_.castArray(t),!window.confirm('Delete "'+this.setting.label+'" data?'))return;let r=t.join(", ").replace("books","library"),i="Failed to remove data for: <strong>"+r+"</strong>",o="Successfully removed data for: <strong>"+r+"</strong>",a=function(l){n.loading=!1,n.$toast.error(i+" ("+l+")",n.toastOpts)};chrome.storage.local.get(null).then(l=>{_.each(t,function(c){let u;c==="isbn"&&(c="books",u="isbn"),_.each(_.range(0,l[c+"-chunk-length"]),function(f){u==="isbn"?_.each(l["books-chunk-"+f],function(p){p.isbns&&delete p.isbns}):delete l[c+"-chunk-"+f]}),(c!=="books"||c==="books"&&u!=="isbn")&&(delete l[c+"-chunk-length"],_.remove(l.chunks,function(f){return f===c})),c==="books"&&_.remove(l.chunks,function(f){return f==="isbn"}),delete l.version[c==="books"?"library":c],l.config&&l.config.steps&&delete l.config.steps}),l.chunks.length<1&&delete l.chunks,chrome.storage.local.clear().then(()=>{chrome.storage.local.set(l).then(()=>{e&&e(l),chrome.runtime.sendMessage({action:"rebuild-context-menu"}),n.$toast.success(o,n.store.toastOpts),n.$dataChecker(l)}).catch(a)}).catch(a)}).catch(a)},notifier(t){if(t.disabled&&t.label==="Library"){let e=_.find(this.store.sticky.extractSettings,{value:!0,name:"collections"});e=_.get(e,"label","");let n=_.find(this.store.sticky.extractSettings,{value:!0,name:"isbn"});n=_.get(n,"label","");let s=[e,n];s=_.compact(s),s=_.join(s," and "),this.$toast.error(`<span>Uncheck <strong>${s}</strong> to disable library.</span>`,this.store.toastOpts)}}}},gc=["content"],bc={class:"control pointer"},yc=["disabled"],_c=["content"],xc=["disabled"],wc={class:"checkbox"},Sc=["content"],vc={class:"icon is-small"};function kc(t,e,n,s,r,i){const o=mc,a=dc,l=lc,c=rt("tippy");return oe((D(),L("div",{class:_e(["field has-addons",{disabled:n.setting.disabled}]),style:{margin:"5px"},content:n.setting.cannotAccessTippy,onClick:e[3]||(e[3]=u=>i.notifier(n.setting))},[S("p",bc,[S("button",{class:"checbox-wrapper button is-small",onClick:e[0]||(e[0]=u=>i.settingChanged()),disabled:i.settingDisabled},[S("div",{class:_e(["button",[n.setting.value?n.setting.type:null]])},[n.setting.value?(D(),ve(o,{key:0})):(D(),ve(a,{key:1,style:{opacity:".7"}}))],2)],8,yc)]),oe((D(),L("p",{class:"control full-width pointer",content:n.setting.tippy},[S("button",{class:"button checkbox-btn is-small",disabled:i.settingDisabled,onClick:e[1]||(e[1]=u=>i.settingChanged())},[S("label",wc,ye(n.setting.label),1)],8,xc)],8,_c)),[[c]]),i.settingHasData?oe((D(),L("p",{key:0,class:"control delete-btn",content:"Remove previously extracted data."+(n.setting.trashTippy?"<br>"+n.setting.trashTippy:"")},[S("button",{class:"button is-small remove-individual-sections-icon",onClick:e[2]||(e[2]=u=>i.deleteChunkData(n.setting.deleteChunks||[n.setting.name]))},[S("span",vc,[ce(l)])])],8,Sc)),[[c]]):Ce("",!0)],10,gc)),[[c,{allowHTML:!0,interactive:!0}]])}const Tc=Te(hc,[["render",kc],["__scopeId","data-v-0015a3ff"]]);const Ec={data:function(){return{store:this.$store.state}},computed:{extraSettings:function(){return _.filter(this.store.sticky.extractSettings,{kind:"extra"})}},methods:{}},Ac={class:"settings-wrapper box panel",animation:"slide"},Oc={class:"extract-settings"},Rc={class:"row is-0 setting-checkboxes"};function Dc(t,e,n,s,r,i){const o=Tc,a=ic;return D(),L("div",Ac,[S("div",Oc,[e[0]||(e[0]=S("div",{class:"settings-heading"},[S("span",{class:"title is-4"},"Extraction Settings")],-1)),S("div",Rc,[(D(!0),L(Fs,null,$s(t.$store.getters.settings_mainSteps,(l,c)=>(D(),L("div",{key:l.name,class:_e({checked:l.value,unchecked:!l.value})},[ce(o,{class:_e({"partial-extraction":t.store.storageHasData[l.name]}),index:c,settings:t.$store.getters.settings_mainSteps,setting:l},null,8,["class","index","settings","setting"])],2))),128))]),ce(a)])])}const Pc=Te(Ec,[["render",Dc],["__scopeId","data-v-051c0d09"]]);const Cc={name:"menuScreen",props:["domainExtension","wishlistUrl"],mixins:[bn],data(){return{store:this.$store.state,hasData:null,hasConfig:null,settingsOpen:!0,loading:!0,isFirefox:!1,isChrome:!1,releaseURL:"",showDeleteBtns:!1,showPartialExtraction:!1,exportRawDataDisabled:!1,cannotAccessWishlist:!1}},computed:{dataVersionMismatch:function(){return[]}},created:function(){this.hasData=this.$store.state.storageHasData,this.hasConfig=this.$store.state.storageConfig,this.checkBrowser(),this.makeReleaseURLs()},mounted:function(){this.$nextTick(function(){setTimeout(()=>{this.loading=!1},300)})},methods:{checkAccess:function(t){t=t||{},axios.get(t.to).then(function(){t.success&&t.success()}).catch(function(){t.failed&&t.failed()}).then(function(){t.finally&&t.finally()})},checkBrowser:function(){this.isFirefox=chrome.runtime.getURL("").startsWith("moz-extension://"),this.isChrome=chrome.runtime.getURL("").startsWith("chrome-extension://")},makeReleaseURLs:function(){this.releaseURL=this.isFirefox?"https://chrome.google.com/webstore/detail/audible-library-extractor/deifcolkciolkllaikijldnjeloeaall":"https://addons.mozilla.org/firefox/addon/audible-library-extractor/"},extract:function(){this.takeNextStep("extract")},takeNextStep:function(t,e){e||(e={steps:_.map(_.filter(this.store.sticky.extractSettings,function(n){return n.value&&!n.extra}),function(n){return{name:n.name,value:n.value}})}),e.extraSettings=_.map(_.filter(this.store.sticky.extractSettings,"extra"),function(n){return{name:n.name,value:n.value,deactivated:!1}}),this.$compEmitter.emit("start-extraction",{step:t,config:e})}}},Lc={key:0,class:"message is-info"},Nc={class:"message-body"},Mc={style:{color:"#f7991c"}},Ic={content:"<div style='display: block; text-align: left;'><ol style='margin-left: 15px;'><li>Updates stored data that is likely to change</li><li>Does a full extract on newly added books</li><li>Clears data of removed books</li></ol><span style='display: inline-block; margin-top: 6px; color: #157df0;'>In the case of ISBN extraction, books that already have ISBNs are ignored. A large amount of books (+100) without the numbers will still take quite a while to extract.</span></div>",style:{cursor:"default","text-decoration":"underline"}},qc={content:"The data structure may change from version to version, in which case a full extraction is needed or at least preferred. <br><br>You need to remove extracted data in order to do a full extraction.",style:{cursor:"default","text-decoration":"underline"}},Fc={class:"extract-wrapper"},$c={class:"field has-addons extract-btn"},Bc={class:"control"},Uc={class:"control"},Hc={class:"field has-addons other-btns"},zc={class:"button control is-small",tag:"a",href:"https://joonaspaakko.gitbook.io/audible-library-extractor/",target:"_blank"},jc=["disabled"],Wc={id:"footer",class:"is-small has-text-grey-light"},Gc={target:"_blank",rel:"noopener noreferrer",href:"https://github.com/joonaspaakko/audible-library-extractor/releases/latest",content:"It may take a few days for a new release to propagate from Github to Firefox and Chrome web store."},Yc={style:{"margin-top":"10px"}},Vc={style:{border:"1px dashed #e1e1e1",padding:"10px 15px",display:"inline-block"}},Xc={key:1,class:"extraction-loading"};function Jc(t,e,n,s,r,i){const o=Pc,a=jl,l=Ul,c=Fl,u=Rl,f=rt("tippy");return D(),L("div",null,[r.loading?(D(),L("div",Xc,[ce(u,{class:"spin"})])):(D(),L("div",{key:0,id:"ale-menu-screen",class:_e({"show-delete-btns":r.showDeleteBtns,"show-partial-extraction":r.showPartialExtraction})},[ce(o),t.$store.getters.partialDataSettings_any?(D(),L("article",Lc,[S("div",Nc,[S("strong",null,[e[10]||(e[10]=z("Previously extracted data detected: ")),S("span",Mc,[e[8]||(e[8]=z("a faster ")),oe((D(),L("span",Ic,e[7]||(e[7]=[z("partial extraction")]))),[[f,{allowHTML:!0}]]),e[9]||(e[9]=z(" is used"))]),e[11]||(e[11]=z()),S("span",{class:"init-show-partial-extraction",style:{color:"#f7991c"},onMouseover:e[0]||(e[0]=p=>r.showPartialExtraction=!0),onMouseleave:e[1]||(e[1]=p=>r.showPartialExtraction=!1)},"where applicable.",32)]),e[13]||(e[13]=S("br",null,null,-1)),e[14]||(e[14]=z(" If you need to do a ")),oe((D(),L("span",qc,e[12]||(e[12]=[z("full extraction")]))),[[f,{maxWidth:310}]]),e[15]||(e[15]=z(", you can remove stored data using ")),S("span",{class:"init-show-detele-btns",onMouseover:e[2]||(e[2]=p=>r.showDeleteBtns=!0),onMouseleave:e[3]||(e[3]=p=>r.showDeleteBtns=!1)},"these buttons",32),e[16]||(e[16]=z(". "))])])):Ce("",!0),S("div",null,[S("div",Fc,[oe(S("div",$c,[S("p",Bc,[S("button",{class:"button is-info extract is-large",onClick:e[4]||(e[4]=(...p)=>i.extract&&i.extract(...p)),expanded:""}," Extract selected items ")]),S("p",Uc,[S("button",{class:"button is-dark is-large",onClick:e[5]||(e[5]=(...p)=>i.extract&&i.extract(...p))},[ce(a)])])],512),[[yn,!r.store.extractionButtonDisabled&&!r.loading]]),S("div",Hc,[S("button",zc,[e[17]||(e[17]=z(" Documentation ")),ce(l)]),S("button",{class:"button control is-small",disabled:t.$store.getters.mainDataExists?null:!0,onClick:e[6]||(e[6]=p=>i.takeNextStep("output"))},[e[18]||(e[18]=z(" Open gallery ")),ce(l)],8,jc)])])]),ce(c),S("div",Wc,[e[22]||(e[22]=z(" Project source files in ")),e[23]||(e[23]=S("a",{href:"https://github.com/joonaspaakko/audible-library-extractor"},"Github",-1)),e[24]||(e[24]=z(". ")),e[25]||(e[25]=S("br",null,null,-1)),e[26]||(e[26]=z(" Post issues, questions, and suggestions at: ")),e[27]||(e[27]=S("a",{href:"https://github.com/joonaspaakko/audible-library-extractor/issues"},"Github issues",-1)),e[28]||(e[28]=z(". ")),e[29]||(e[29]=S("br",null,null,-1)),e[30]||(e[30]=S("br",null,null,-1)),oe((D(),L("a",Gc,e[19]||(e[19]=[S("img",{src:"https://img.shields.io/github/v/release/joonaspaakko/audible-library-extractor?include_prereleases&label=latest%20release (Github)&color=6e41bf",alt:""},null,-1)]))),[[f]]),e[31]||(e[31]=Gr('<a target="_blank" rel="noopener noreferrer" href="https://github.com/joonaspaakko/audible-library-extractor/releases/latest" data-v-8824bf08><img src="https://img.shields.io/github/release-date/joonaspaakko/audible-library-extractor?label=latest%20release&amp;color=6e41bf" alt="" data-v-8824bf08></a><a target="_blank" rel="noopener noreferrer" href="https://github.com/joonaspaakko/audible-library-extractor/labels/bug" data-v-8824bf08><img src="https://img.shields.io/github/issues/joonaspaakko/audible-library-extractor/bug?label=known bugs&amp;color=6e41bf" alt="" data-v-8824bf08></a><br data-v-8824bf08><a target="_blank" rel="noopener noreferrer" href="https://chrome.google.com/webstore/detail/audible-library-extractor/deifcolkciolkllaikijldnjeloeaall" data-v-8824bf08><img src="https://img.shields.io/chrome-web-store/v/deifcolkciolkllaikijldnjeloeaall?color=2acb41&amp;label=latest%20release (Chrome)" alt="" data-v-8824bf08></a><a target="_blank" rel="noopener noreferrer" href="https://addons.mozilla.org/en-US/firefox/addon/audible-library-extractor/" data-v-8824bf08><img src="https://img.shields.io/amo/v/audible-library-extractor?label=latest%20release (Firefox)" alt="" data-v-8824bf08></a>',5)),S("div",Yc,[S("span",Vc,[e[20]||(e[20]=z(" You're currently using ")),S("strong",null,"version "+ye(r.store.appVersion),1),e[21]||(e[21]=z(". "))])])])],2))])}const Qc=Te(Cc,[["render",Jc],["__scopeId","data-v-8824bf08"]]);function se(t){this.queue=[],this.timeslotRequests=0,this.interceptors={request:null,response:null},this.handleRequest=this.handleRequest.bind(this),this.handleResponse=this.handleResponse.bind(this),this.enable(t)}se.prototype.getMaxRPS=function(){var t=this.perMilliseconds/1e3;return this.maxRequests/t};se.prototype.getQueue=function(){return this.queue};se.prototype.setMaxRPS=function(t){this.setRateLimitOptions({maxRequests:t,perMilliseconds:1e3})};se.prototype.setRateLimitOptions=function(t){t.maxRPS?this.setMaxRPS(t.maxRPS):(this.perMilliseconds=t.perMilliseconds,this.maxRequests=t.maxRequests)};se.prototype.enable=function(t){function e(n){return Promise.reject(n)}this.interceptors.request=t.interceptors.request.use(this.handleRequest,e),this.interceptors.response=t.interceptors.response.use(this.handleResponse,e)};function Kc(t){t.cancelToken&&t.cancelToken.throwIfRequested()}se.prototype.handleRequest=function(t){return new Promise(function(e,n){this.push({resolve:function(){try{Kc(t)}catch(s){return n(s),!1}return e(t),!0}})}.bind(this))};se.prototype.handleResponse=function(t){return this.shift(),t};se.prototype.push=function(t){this.queue.push(t),this.shiftInitial()};se.prototype.shiftInitial=function(){setTimeout(function(){return this.shift()}.bind(this),0)};se.prototype.shift=function(){if(!!this.queue.length){if(this.timeslotRequests===this.maxRequests){this.timeoutId&&typeof this.timeoutId.ref=="function"&&this.timeoutId.ref();return}var t=this.queue.shift(),e=t.resolve();if(this.timeslotRequests===0&&(this.timeoutId=setTimeout(function(){this.timeslotRequests=0,this.shift()}.bind(this),this.perMilliseconds),typeof this.timeoutId.unref=="function"&&this.queue.length===0&&this.timeoutId.unref()),!e){this.shift();return}this.timeslotRequests+=1}};function Zc(t,e){var n=new se(t);return n.setRateLimitOptions(e),t.getQueue=se.prototype.getQueue.bind(n),t.getMaxRPS=se.prototype.getMaxRPS.bind(n),t.setMaxRPS=se.prototype.setMaxRPS.bind(n),t.setRateLimitOptions=se.prototype.setRateLimitOptions.bind(n),t}var Ot=Zc;const eu={methods:{minutesToMilliseconds:function(t){return t*60*1e3},secondsToMilliseconds:function(t){return t*1e3},amapxios:function(t){const e=this,n=_.cloneDeep(t.rateLimit||this.$store.state.axiosRateLimit);e.$store.state.sticky.slowExtract&&(n.maxRequests=_.clamp(Math.ceil(n.maxRequests*.5),1,n.maxRequests));const s=this.minutesToMilliseconds(1);let r=axios.create();r=Ot(r,n);const i=o=>{let a=new Url(DOMPurify.sanitize(o));if(a.query.asin)return a.query.asin;{const l=a.path.split("/");return l[l.length-1]}};asyncMapLimit(t.requests,n.maxRequests,function(o,a){const l=t.config||{},c=o.requestUrl||o.url||o,u=o.requestId||o.asin||i(c),f=new AbortController;if(_.includes(e.$store.state.failedRequests,u)){a(null,null);return}l.signal=f.signal,l.validateStatus=function(g){return g>=200&&g<400};let h=setTimeout(()=>{f.abort("Request took too long... ("+c+")")},s),m=null;r.get(c,l).then(function(g){try{t.step(g,function(y){m=y},o)}catch(y){console.log("%caxios caught an error (step)","background: #0082ab; color: #fff; padding: 2px 5px; border-radius: 8px;",y)}}).catch(function(g){const y=_.get(g,"response.status");e.$store.commit("update",{key:"lastFailedRequestStatus",value:y}),(y==404||y==503)&&e.$store.commit("pushToFailedRequests",u),console.log("%caxios caught an error (step)","background: #f41b1b; color: #fff; padding: 2px 5px; border-radius: 8px;",`

`,c,`

`,g),_.get(g,"message")==="canceled"&&e.$store.commit("pushToCanceledRequests",c);try{t.returnCatch&&t.step(_.get(g,"response",g),function(v){m=v},o,"processingError")}catch(v){console.log("%caxios caught an error (step)","background: #0082ab; color: #fff; padding: 2px 5px; border-radius: 8px;",v)}}).then(function(){clearTimeout(h),a(null,m)})},function(o,a){o?(console.log("%caxios caught an error (done)","background: #f79a33; color: #fff; padding: 2px 5px; border-radius: 8px;",o),t.done(null,!0)):(a=t.flatten?_.flatten(a):a,a=_.compact(a),t.done(a))})},chunkAmapxios:function(t){const e=this,n=_.cloneDeep(t.rateLimit||this.$store.state.axiosRateLimit);e.$store.state.sticky.slowExtract&&(n.maxRequests=_.clamp(Math.ceil(n.maxRequests*.5),1,n.maxRequests));const s=this.minutesToMilliseconds(1);let r=axios.create();r=Ot(r,n);const i=u=>{let f=new Url(DOMPurify.sanitize(u));if(f.query.asin)return f.query.asin;{const p=f.path.split("/");return p[p.length-1]}},o=300,a=1e4,l=_.chunk(t.requests,o);let c=-1;asyncMapLimit(l,1,function(u,f){++c,e.$store.commit("update",{key:"taking_a_break",value:!0}),setTimeout(()=>{e.$store.commit("update",{key:"taking_a_break",value:!1}),asyncMapLimit(u,n.maxRequests,function(p,h){const m=t.config||{},g=p.requestUrl||p.url||p,y=p.requestId||p.asin||i(g),v=new AbortController;if(_.includes(e.$store.state.failedRequests,y)){h(null,null);return}m.signal=v.signal,m.validateStatus=function(E){return E>=200&&E<400};let O=setTimeout(()=>{v.abort("Request took too long... ("+g+")")},s),w=null;r.get(g,m).then(function(E){try{t.step(E,function(N){w=N},p)}catch(N){console.log("%caxios caught an error (step)","background: #0082ab; color: #fff; padding: 2px 5px; border-radius: 8px;",N)}}).catch(function(E){const N=_.get(E,"response.status");e.$store.commit("update",{key:"lastFailedRequestStatus",value:N}),(N==404||N==503)&&e.$store.commit("pushToFailedRequests",y),console.log("%caxios caught an error (step)","background: #f41b1b; color: #fff; padding: 2px 5px; border-radius: 8px;",`

`,g,`

`,E),_.get(E,"message")==="canceled"&&e.$store.commit("pushToCanceledRequests",g);try{t.returnCatch&&t.step(_.get(E,"response",E),function(U){w=U},p,"processingError")}catch(U){console.log("%caxios caught an error (step)","background: #0082ab; color: #fff; padding: 2px 5px; border-radius: 8px;",U)}}).then(function(){clearTimeout(O),h(null,w)})},function(p,h){p?f(null,null):(h=t.flatten?_.flatten(h):h,h=_.compact(h),f(null,h))})},c===0?0:a)},function(u,f){u?(console.log("%caxios caught an error (done)","background: #f79a33; color: #fff; padding: 2px 5px; border-radius: 8px;",u),t.done(null,!0)):(f=t.flatten?_.flatten(f):f,f=_.compact(f),t.done(f))})}}},tu={methods:{scrapingPrep:function(t){const e=this;t=t||{};let n=new Url(DOMPurify.sanitize(t.url));if(_.includes(e.$store.state.failedRequests,n)){t.done({});return}const r=axios.create(),i=_.cloneDeep(this.$store.state.axiosRateLimit);i.maxRequests=_.clamp(Math.ceil(i.maxRequests*.5),1,i.maxRequests);const o=Ot(r,i);waterfall([function(a){n.query.ale=!0,n.query.bp_ua="yes";let l={};l.urlObj=n;let c=[null,{}];t.skipFirstCall?(c=e.getMaxPageSize(l,t,t.response,a),a(c[0],c[1])):o.get(n.toString()).then(function(u){c=e.getMaxPageSize(l,t,u,a)}).catch(function(u){_.get(u,"response.status")==404&&e.$store.commit("pushToFailedRequests",requestURL),c=[!0,{}]}).then(function(){a(c[0],c[1])})},function(a,l){o.get(a.urlObj.toString()).then(function(c){const f=$($.parseHTML(c.data)).find("div.adbl-main").find(".pagingElements"),p=f.length>0?parseFloat(DOMPurify.sanitize(f.find(".pageNumberElement:last").text())):1;a.pageNumbers=_.range(1,p+1),a.pageSize=a.urlObj.query.pageSize||null,l(null,a)})}],function(a,l){t.done(l)})},getMaxPageSize:function(t,e,n,s){const r=_.get(n,"data");if(!r)return[null,null];const i=$($.parseHTML(r)).find("div.adbl-main"),o=i.find('select[name="pageSize"]'),a=o.length>0?DOMPurify.sanitize(o.find("option:last").val()):null;return t.urlObj.query.pageSize=e.maxSize||t.urlObj.query.pageSize||a,e.returnResponse&&(t.response=n),!i.find(".pagingElements").length||!a||a<50||e.returnAfterFirstCall?(t.pageNumbers=[1],t.pageSize=t.urlObj.query.pageSize,[!0,t]):[null,t]},getPageNumbers:function(t){const n=$($.parseHTML(t.data)).find("div.adbl-main").find(".pagingElements"),s=n.length>0?parseFloat(DOMPurify.sanitize(n.find(".pageNumberElement:last").text())):1;return _.range(1,s+1)}}},nu={methods:{getDataFromCarousel:function(t,e,n,s){const r=e.querySelector("#adbl-web-carousel-c"+s);if(r){const i=[],o=r.querySelectorAll(".carousel-product");_.each(o,function(a){const l={};let c=a.querySelector('[id^="product-carousel-image"]');if(c&&(c=c.getAttribute("src")||c.getAttribute("data-lazy")),!c)return!1;let u=c.match(/\/images\/I\/(.*)._SL/);if(u&&u[1]&&(u=""+DOMPurify.sanitize(u[1])),!u)return!1;l.cover=u;let f=a.querySelector("[data-asin]");if(f&&(f=f.getAttribute("data-asin")),f&&(f=""+DOMPurify.sanitize(f)),!f)return!1;l.asin=f;const p=a.querySelector("[id^=product-list-flyout] ul");let h,m;if(p&&(h=p.querySelectorAll("li:not(.bc-size-base)"),h)){if(m=p.querySelector("li.bc-size-base:nth-child(2)"),m){let g=m.querySelector(".bc-pub-offscreen");g&&g.remove()}m&&(m=m.textContent),m&&(m=DOMPurify.sanitize(m.trim())),m&&(l.subHeading=m)}h&&_.each(h,function(g,y){let v=g.querySelector(".bc-pub-offscreen");v&&v.remove();let T=g.textContent;if(T&&(T=DOMPurify.sanitize(T.trimAll())),T&&!g.querySelector("h2")&&(T=T.trimToColon()),!T)return!1;var O=y+1;switch(O){case 1:l.title=T;break;case 2:l.authors=T;break;case 3:l.narrators=T;break;case 4:l.length=T;break}}),i.push(l)}),i.length>0&&(t[n]=i)}}}},su={methods:{getDataFromLibraryPages:function(t,e){const n=this;_.find(t.config.steps,{name:"books"})?(this.$store.commit("update",[{key:"bigStep.step",value:0},{key:"subStep.step",value:0}]),this.$store.commit("update",[{key:"bigStep.title",value:"Library"},{key:"bigStep.step",add:1},{key:"subStep.step",add:1},{key:"subStep.max",value:4},{key:"progress.step",value:0},{key:"progress.max",value:0},{key:"progress.text",value:this.$store.state.storageHasData.books?"Updating old books and adding new books...":"Scanning library for books..."}]),n.scrapingPrep({url:n.libraryUrl,maxSize:20,done:function(s){const r=s.urlObj.toString();n.amapxios({requests:_.map(s.pageNumbers,function(i){return{requestUrl:r+"&page="+i,requestId:"library-page-"+i}}),step:function(i,o){n.processLibraryPage(i,t,o)},flatten:!0,done:function(i){n.$nextTick(function(){if(t.books=i,t.books&&t.books.length){const o=_.xorBy(t.books,i,"asin");if(o.length>0){let a=_.filter(o,function(l){return!l.isNewThisRound});a.length>0&&(n.removeFromSeries(t.series,a),n.removeFromCollections(t.collections,a))}if(t.wishlist&&t.wishlist.length>0){let a=_.filter(t.books,"isNewThisRound");a.length>0&&(a=_.map(a,"asin"),_.remove(t.wishlist,function(l){return _.includes(a,l.asin)}))}}t.config.getStorePages="books",n.$nextTick(function(){e(null,t)})})}})}})):(n.$store.commit("resetProgress"),e(null,t))},processLibraryPage:function(t,e,n){let s=this;const r=$($.parseHTML(t.data)).find("div.adbl-main")[0];t.data=null;const i=[],o=r.querySelectorAll("#adbl-library-content-main > .adbl-library-content-row");each(o,function(a){const l={is:{product:a.querySelector('[name="contentType"][value="Product"]'),performance:a.querySelector('[name="contentType"][value="Performance"]'),lecture:a.querySelector('[name="contentType"][value="Lecture"]'),podcast:a.querySelector('[name="contentType"][value="Podcast"]'),podcastParent:a.querySelector('[name="contentDeliveryType"][value="PodcastParent"]')}};let c=a.querySelector("[data-asin]");c=c.getAttribute("data-asin"),c=DOMPurify.sanitize(c);const u=_.find(e.books,["asin",c]),f=s.$store.state.storageHasData.books&&!u||!s.$store.state.storageHasData.books;let p=s.$store.state.storageHasData.books&&u?u:{};const h=_.get(u,"isbns");h&&(p.isbns=h);let m;if(l.is.podcast&&(m=a.querySelector(".adbl-episodes-link > a")),m||(m=a.querySelector(":scope > div > div > div > div > span > ul > li:nth-child(1) > a")),m){let N=new Url(window.location.origin+DOMPurify.sanitize(m.getAttribute("href")));N.clearQuery(),p.storePageRequestUrl=N.toString()}if(f){p.asin=c;const N=a.querySelector("a > img.bc-image-inset-border:first-of-type")||a.querySelector(":scope > div > div > div > a > img.bc-image-inset-border")||a.querySelector(":scope > div > div > div > img.bc-image-inset-border");if(N){let j=N.getAttribute("src");if(j=DOMPurify.sanitize(j),j.lastIndexOf("img-coverart-prod-unavailable")<0){let R=j.match(/\/images\/I\/(.*)._SL/);R=_.get(R,"[1]"),R&&(p.cover=R)}}p.title=DOMPurify.sanitize(a.querySelector(":scope > div > div > div > div > span > ul > li:nth-child(1)").textContent.trimAll()),p.authors=s.getArray(a.querySelectorAll(".authorLabel a")),p.narrators=s.getArray(a.querySelectorAll(".narratorLabel a")),p.series=s.getSeries(a.querySelector(".seriesLabel > span")),p.blurb=DOMPurify.sanitize(a.querySelector(".summaryLabel > span").textContent.trimAll()),a.querySelector('input[value="AudibleDiscovery"]')&&(p.fromPlusCatalog=!0)}l.is.podcast&&(p.format="Podcast"),l.is.podcastParent&&(p.podcastParent=!0),a.querySelector(".adbl-library-inaccessible-button")?p.unavailable=!0:p.unavailable&&delete p.unavailable,p.downloaded=a.querySelector(".adbl-library-action > div:nth-child(4) > span")?!0:null,a.querySelector('[id^="remove-from-favorites-button"]:not(.bc-pub-hidden)')?p.favorite=!0:p.favorite&&delete p.favorite;const v=a.querySelector('[id^="time-remaining-display"] [role="progressbar"]'),T=!!a.querySelector('[id^="time-remaining-finished"]:not(.bc-pub-hidden)');let O=a.querySelector('[id^="time-remaining"]:not(.bc-pub-hidden)');O&&(O=DOMPurify.sanitize(O.textContent.trimAll())),v||T?p.progress=O:(p.length=O,p.progress=0);let w=a.querySelector('[id^="collectionIds-"]');if(w&&delete p.collectionIds,w&&(w=w.getAttribute("value")),w&&(w=w.replace(/^\[/,"").replace(/\]$/,"").trim()),w&&(w=w.split(", ")),w&&w.length>0){const N=["","__PENDING","__PURCHASE"];_.remove(w,function(U){return _.includes(N,U.trim())}),w.length>0&&(p.collectionIds=w)}let E=a.querySelector("div.bc-rating-stars.adbl-prod-rate-review-bar.adbl-prod-rate-review-bar-overall");if(E&&(E=E.getAttribute("data-star-count")),E>0&&(p.myRating=DOMPurify.sanitize(E)),p=_.omitBy(p,_.isNull),s.$store.state.storageHasData.books){let N=!u,U=u&&u.isNew;(N||U)&&(p.isNew=!0)}f&&(p.isNewThisRound=!0,s.$store.commit("update",{key:"progress.max",add:1})),i.push(p)}),s.$nextTick(function(){n(i)})}}},ru={methods:{getDataFromStorePages:function(t,e){this.$store.commit("update",{key:"subStep.step",add:1});const n=this;let s=[];const r=t.config.getStorePages;t.config.getStorePages&&(s=this.prepStorePages(t,t.config.getStorePages),t.config.getStorePages=!1),s.length?(t.config.test||this.$store.commit("update",[{key:"progress.step",value:0},{key:"progress.bar",value:!0},{key:"progress.text",value:"Fetching additional data from store pages..."}]),n.amapxios({requests:s,returnCatch:!0,step:function(o,a,l,c){_.get(l,"requestUrl")&&delete l.requestUrl,t.config.test||n.$store.commit("update",{key:"progress.text2",value:_.get(l,"title")});let u=_.get(o,"status");u=u?_.toNumber(u):0,_.inRange(u,200,400-1)?n.getStorePageData(o,l,t.config.test):l&&(l.storePageMissing=!0),t.config.test||n.$store.commit("update",{key:"progress.step",add:1}),a(l)},flatten:!0,done:i})):i();function i(){t.config.test||n.$store.commit("resetProgress"),r==="wishlist"&&n.$store.commit("update",[{key:"subStep.step",value:0},{key:"subStep.max",value:0}]),n.$nextTick(function(){e(null,t)})}},prepStorePages:function(t,e){let n=this;_.each(t[e],function(r){n.$store.state.storageHasData[e]&&!t.config.test?r.isNewThisRound&&(r.requestUrl=r.storePageRequestUrl):r.requestUrl=r.storePageRequestUrl;let i=new Url(r.requestUrl);i.query.ipRedirectOverride=!0,i.query.overrideBaseCountry=!0,r.requestUrl=i.toString(),delete r.storePageRequestUrl});let s=[];return n.$store.state.storageHasData[e]&&!t.config.test?s=_.filter(t[e],"isNewThisRound"):s=t[e]||[],s},getStorePageData:function(t,e,n){let s=this;var r=$($.parseHTML(t.data));const i=r.find("div.adbl-main")[0];n||t.request.responseURL.lastIndexOf(e.asin)<0&&(e.storePageChanged=!0);let o=i&&i.querySelector("#sample-player-"+e.asin);if(o||(o=i&&i.querySelector(`#jpp-sample-button[data-asin="${e.asin}"]`)),n||o){const u=(h=>{const m=h.find("#bottom-0").children();let g=[];m.each((T,O)=>{const w=$(O).text();if(w){const E=JSON.parse(w);g=_.concat(g,_.castArray(E))}});const y={};_.each(g,T=>{_.merge(y,T)}),_.unset(y,"duration");const v=h.find("adbl-product-hero adbl-product-metadata > script, adbl-product-details adbl-product-metadata > script");return v&&v.each((T,O)=>{const w=$(O).text();if(w){const E=JSON.parse(w);_.merge(y,E)}}),y})(r);if(r=null,t.data=null,e.storePageMissing=!1,!e.cover&&u.image){let h=DOMPurify.sanitize(u.image);h=h.match(/\/images\/I\/(.*)._SL/),h=_.get(h,"[1]"),h&&(e.cover=h)}if(!e.cover){const h=i.querySelector("#center-1 > div > div > div > div.bc-col-responsive > div > div:nth-child(1) > img"),m=i.querySelector("#center-1 > div > div.bc-container > div > div:nth-child(1) > img");let g=h||m;if(g&&(g=g.getAttribute("src"),g=DOMPurify.sanitize(g),g.lastIndexOf("img-coverart-prod-unavailable")<0)){let y=g.match(/\/images\/I\/(.*)._SL/);y=_.get(y,"[1]"),y&&(e.cover=y)}}if(e.titleShort=DOMPurify.sanitize(u.name),(!e.titleShort||!e.subtitle)&&i.querySelector("adbl-title-lockup")){if(!e.titleShort){const m=i.querySelector('[slot="title"]');m&&(e.titleShort=DOMPurify.sanitize(m.textContent))}if(!e.subtitle){const m=i.querySelector('[slot="subtitle"]');m&&(e.subtitle=DOMPurify.sanitize(m.textContent))}if(!e.subtitle){const m=i.querySelector(".subtitle");m&&(e.subtitle=DOMPurify.sanitize(m.textContent.trimAll()))}}if(u.aggregateRating){const h=DOMPurify.sanitize(u.aggregateRating.ratingValue);h&&(e.rating=_.toNumber(_.toNumber(h).toFixed("1").replace(/\.0$/,"")));const m=DOMPurify.sanitize(u.aggregateRating.ratingCount);e.ratings=_.toNumber(m)}else{const h=i.querySelector(".ratingsLabel > a");if(h){let g=h.textContent;g&&(g=DOMPurify.sanitize(g),g=g.match(/\d/g),g=_.isArray(g)?_.join(g,""):g,g=parseFloat(g),e.ratings=g)}const m=i.querySelector(".ratingsLabel > span:last-of-type");m&&(e.rating=Number(DOMPurify.sanitize(m.textContent.trimAll())))}if(u.description&&(e.summary=DOMPurify.sanitize(u.description)),e.summary||(e.summary=s.getSummary(i.querySelector(".productPublisherSummary > .bc-section > .bc-box:first-of-type")||i.querySelector("#center-1 > div.bc-container > div > div.bc-col-responsive.bc-col-6"))),u.datePublished&&(e.releaseDate=DOMPurify.sanitize(u.datePublished)),!e.releaseDate&&u.releaseDate){const h=DOMPurify.sanitize(u.releaseDate);e.releaseDate=s.fixDates(h)}if(e.releaseDate||(e.releaseDate=s.fixDates(i.querySelector(".releaseDateLabel"))),u.publisher){const h=[];_.each(_.castArray(u.publisher),m=>{const g=_.get(m,"name");h.push({name:g})}),e.publishers=h}else{const h=i.querySelectorAll(".publisherLabel > a");e.publishers=s.getArray(h)}if(e.length=0,!e.length&&u.duration)e.length=s.shortenLength(u.duration);else if(!e.length){const h=i.querySelector(".runtimeLabel");if(h){const m=h.textContent.trimToColon();e.length=s.shortenLength(m)}}if(u.itemListElement){const h=[];_.each(u.itemListElement,m=>{const g=_.get(m,"item");if(!g)return;const y=g.name||"";if(!y||y.match(/home/im))return;const T=_.get(g,"@id");h.push({name:y,url:_.get(T.match(/\/cat\/.+\/(\d+)/im),"1")})}),h.length&&(e.categories=h)}if(u.categories&&!_.get(e.categories,"1")){const h=_.castArray(u.categories);h.length&&(e.categories=_.map(h,m=>({name:m.name,url:_.get(m.url.match(/\/cat\/.+\/(\d+)/im),"1")})))}if(!_.get(e.categories,"1")){const h=i.querySelector(".categoriesLabel")?i.querySelectorAll(".categoriesLabel > a"):i.querySelectorAll(".bc-breadcrumb > a");h&&(e.categories=s.getArray(h))}if(u.inLanguage)u.language?e.language=DOMPurify.sanitize(u.language):u.language&&(e.language=DOMPurify.sanitize(_.startCase(u.inLanguage)));else{const h=i.querySelector(".languageLabel");if(h){let m=h.textContent;m=DOMPurify.sanitize(m),m=m.trimAll(),e.language=m}}if(u.format)e.format=DOMPurify.sanitize(u.format);else{const h=i.querySelector(".format");if(h){let m=h.textContent;m=DOMPurify.sanitize(m),m=m.trimAll(),e.format=m}}u.series?(e.series=[],_.each(u.series,h=>{e.series.push({asin:_.get(h.url.match(/\/.+\/.+\/(.+)\?/im),"1"),name:h.name,bookNumbers:_.toString(h.part).replace(/^[^0-9]*/,"").trim().split(/\s*,\s*/img)})})):e.series||(e.series=s.getSeries(i.querySelector(".seriesLabel"))),e.series&&Array.isArray(e.series)&&(e.series=_.uniqBy(e.series,"asin")),u.listeningEnhancements&&_.find(u.listeningEnhancements,{eventId:"whispersync"})&&(e.whispersync="available");const f=i.querySelector(".ws4vLabel > a");if(f){const m=f.querySelector("img").getAttribute("alt");m&&(m.match(/Voice-enabled/)?e.whispersync="owned":m.match(/Voice-ready/)&&(e.whispersync="available"))}const p=i.querySelector(".product-topictag-impression");if(p){const h=p.querySelectorAll("adbl-chip"),m=[];_.each(h,g=>{const y={name:g.textContent,url:_.get(g.getAttribute("href").match(/\/(adbl_rec_tag.*)\?/im),"1")};m.push(y)}),e.tags=m}else{var a=i.querySelector(".product-topic-tags");if(a){var l=[],c=i.querySelectorAll(".bc-chip-text");each(c,function(h){var m={},g=h.closest("a").getAttribute("href");g&&(g=DOMPurify.sanitize(g),g=new Url(g).path,g=g.split("/").pop(),m.url=DOMPurify.sanitize(g));var y=h.getAttribute("data-text");y&&(m.name=DOMPurify.sanitize(y),l.push(m))}),l.length>0&&(e.tags=l)}}s.getDataFromCarousel(e,i,"peopleAlsoBought",5),s.getDataFromCarousel(e,i,"moreLikeThis",6),e=_.omitBy(e,_.isNull)}else e.storePageMissing=!0}}},iu={methods:{getISBNsFromGoogleBooks:function(t,e){_.find(t.config.steps,{name:"isbn"})?(this.$store.commit("update",[{key:"bigStep.step",value:0}]),this.$store.commit("update",[{key:"bigStep.title",value:"International Standard Book Number (ISBN)"},{key:"bigStep.step",add:1},{key:"progress.text2",value:"(The matching process is relatively loose: beware of false matches)"},{key:"progress.text",value:"Fetching ISBNs from Google Books API..."},{key:"progress.step",value:0},{key:"progress.max",value:0},{key:"progress.bar",value:!0}]),ou(this,t,e)):(this.$store.commit("resetProgress"),e(null,t))}}};function ou(t,e,n){const s=[];let r=_.filter(e.books,function(a){return!a.isbns});_.each(r,function(a){if(a.title&&a.authors){const l=encodeURIComponent(a.title)+"+inauthor:"+encodeURIComponent(a.authors[0].name),c="";s.push({url:"https://www.googleapis.com/books/v1/volumes?"+c+"&maxResults=5&q="+l,asin:a.asin,title:a.title})}}),t.$store.commit("update",{key:"progress.max",add:s.length});const i=axios.create();axiosRetry(i,{retries:7,retryDelay:axiosRetry.exponentialDelay,retryCondition:function(a){return axiosRetry.isNetworkOrIdempotentRequestError(a)||a&&a.response&&a.response.status=="429"}});const o=Ot(i,{maxRequests:6,perMilliseconds:1100});asyncMapLimit(s,18,function(a,l){o.get(a.url,{validateStatus:function(c){return c>=200&&c<400}}).then(function(c){const u=_.find(e.books,{asin:a.asin});if(c&&c.status>=200&&c.status<400&&c.data&&c.data.totalItems){let f=new Xr(c.data.items,{keys:["volumeInfo.title"]});const p=_.map(f.search(u.titleShort),"item"),h=_.find(p,function(m){let g=!1;return _.each(m.volumeInfo.industryIdentifiers,function(y){(y.type==="ISBN_10"||y.type==="ISBN_13")&&(g=!0)}),g});if(h){let m=[];if(_.each(h.volumeInfo.industryIdentifiers,function(g){if(g.type==="ISBN_10"||g.type==="ISBN_13"){let y={type:DOMPurify.sanitize(g.type),identifier:DOMPurify.sanitize(g.identifier)};m.push(y)}}),m.length>0&&(u.isbns=m,_.get(h,"volumeInfo.imageLinks.smallThumbnail"))){const g=DOMPurify.sanitize(h.volumeInfo.imageLinks.smallThumbnail.replace("http://","https://"));t.$store.commit("update",{key:"progress.thumbnail",value:g})}}}u.isbns||console.log("%cCouldn't find ISBN(S): "+u.title,"background: #f41b1b; color: #fff; padding: 2px 5px; border-radius: 8px;",c),t.$store.commit("update",{key:"progress.step",add:1}),l(null)}).catch(c=>{console.log("%cCouldn't find ISBN(S): "+a.title,"background: #f41b1b; color: #fff; padding: 2px 5px; border-radius: 8px;",c.respone),t.$store.commit("update",{key:"progress.step",add:1}),l(null)})},function(a,l){a?console.log(a):t.$nextTick(function(){t.$store.commit("resetProgress"),n(null,e)})})}const Ns={methods:{filterBooksInSeries:function(t){let e=[];const n=_.get(t,"config"),s={library:_.find(_.get(n,"steps"),{name:"books"}),test:_.get(n,"seriesTest")},r=_.get(t,"books",[]);return s.library?e=_.filter(r,function(i){return i.isNewThisRound&&i.series}):s.test&&(e=_.filter(r,function(i){return i.series})),e},getDataFromSeriesPages:function(t,e){const n=this;let s=this.filterBooksInSeries(t);if(!s.length)this.$store.commit("update",{key:"subStep.step",add:3}),i();else{this.$store.commit("update",[{key:"progress.text",value:"Compiling a list of series pages..."},{key:"progress.step",value:0},{key:"progress.max",value:0},{key:"progress.bar",value:!0}]);let o=[];_.each(s,function(a){_.each(a.series,function(l){o.push({url:n.seriesUrl+"/"+l.asin+"?pageSize=50",asin:l.asin,books:[],allBooks:[],length:0})})}),o=_.uniqBy(o,"asin"),o=_.reject(o,{asin:_.isNill}),waterfall([function(a){n.getAllSeriesPages(o,a)},function(a,l){n.getBooksFromSeries(t,a,l)}],function(a,l){r(),_.each(l,function(u){const f=_.find(o,{asin:u.asin});f&&(f.books=f.books.concat(u.books),f.allBooks=f.allBooks.concat(u.allBooks),f.length+=u.length,delete f.pageNumbers,delete f.pageSize,delete f.url)});const c=_.get(t,"series",[]);n.$store.state.storageHasData.books&&c.length?_.each(o,function(u){const f=_.find(c,{asin:u.asin});f?_.merge(f,u):t.series.push(u)}):t.series=o,a&&console.error("%cerror","background: #f41b1b; color: #fff; padding: 2px 5px; border-radius: 8px;",a),i()})}function r(){n.$store.commit("update",[{key:"subStep.step",value:0},{key:"subStep.max",value:0}]),n.$store.commit("resetProgress")}function i(){r(),n.$nextTick(function(){e(null,t)})}},getAllSeriesPages:function(t,e){this.$store.commit("update",{key:"subStep.step",add:1});const n=_.cloneDeep(this.$store.state.axiosRateLimit);n.maxRequests=_.clamp(n.maxRequests*.6,1,n.maxRequests);const s=this;s.amapxios({requests:t,rateLimit:n,step:function(r,i,o){o.pageNumbers=s.getPageNumbers(r),o.pageSize="50",s.$store.commit("update",{key:"progress.max",add:1}),i(o)},flatten:!0,done:function(r,i){let o=[];_.each(r,function(a){_.each(a.pageNumbers,function(l){const c=JSON.parse(JSON.stringify(a));let u=new Url(DOMPurify.sanitize(c.url));u.query.page=l,u.query.pageSize=a.pageSize,c.url=u.toString();const f=u.path.split("/");c.requestId=f[f.length-1],o.push(c)})}),e(null,o)}})},getBooksFromSeries(t,e,n){const s=this;this.$store.commit("update",[{key:"progress.text",value:"Fetching series order..."},{key:"progress.max",value:e.length},{key:"subStep.step",add:1}]);const r=_.cloneDeep(this.$store.state.axiosRateLimit);r.maxRequests=_.clamp(r.maxRequests*.8,1,r.maxRequests),s.amapxios({requests:e,rateLimit:r,step:function(i,o,a){const l=$($.parseHTML(i.data)).find("div.adbl-main")[0];i.data=null;let c=null;const u=l.querySelectorAll(".adbl-impression-container li.productListItem");u.length>0&&(c={asin:a.asin,books:[],allBooks:[],length:u.length},each(u,function(f){let p;const h=f.querySelector("div[data-asin]");let m=DOMPurify.sanitize(f.getAttribute("aria-label").decodeHTMLEntities()),g,y=f.querySelector(".subtitle");if(y?(y=DOMPurify.sanitize(y.textContent.trimAll()),g=m+": "+y):(g=m,m=!1),g===m&&(m=!1),h){const w=h.getAttribute("data-asin");f.querySelector(".adblBuyBoxInLibraryButton")&&c.books.push(DOMPurify.sanitize(w))}else{const w=_.get(t,"books",[]);g&&(p=_.find(w,{title:g})),p||(p=_.find(w,{titleShort:m})),p&&c.books.push(p.asin)}let v={};h?v.asin=DOMPurify.sanitize(h.getAttribute("data-asin")):p&&(v.asin=p.asin),g&&(v.title=g),m&&(v.titleShort=m);let T=f.querySelector(":scope > div:nth-child(1) > div > h2");if(T&&(T=T.textContent),T&&(v.bookNumbers=DOMPurify.sanitize(T.trimAll().replace(/[^\d]*/,"").split(",")[0])),!p&&!f.querySelector(".adblBuyBoxInLibraryButton")&&(v.notInLibrary=!0),f.querySelector('[name="discovery-add-to-library-form"]')&&(v.plus=!0),f.querySelector(".buybox-regular-price")){let w=f.querySelector(".buybox-regular-price").textContent.match(/\d/g);_.map(w,function(U){return parseFloat(U)}).reduce((U,j)=>U+j,0)===0&&(v.free=!0)}const O=f.querySelector("img.bc-image-inset-border");if(O){let w=O.getAttribute("src");if(w=DOMPurify.sanitize(w),w.lastIndexOf("img-coverart-prod-unavailable")<0){let E=w.match(/\/images\/I\/(.*)._SL/);E=_.get(E,"[1]"),E&&(v.cover=E)}}if(!v.bookNumbers){let w;v.title&&(w=v.title.match(/(?:, Book.)(.+)/)),w&&(w=w[1]),w&&(v.bookNumbers=w.replace(/\)$/,""))}v.bookNumbers||(v.bookNumbers=function(w,E,N){const U=_.find(w,{asin:N});if(!U)return;const j=_.find(U.series,{asin:E});if(!!j)return _.isArray(j.bookNumbers)?j.bookNumbers.join(","):j.bookNumbers}(t.books,a.asin,v.asin)),v.bookNumbers||(v.bookNumbers="\u221E"),c.allBooks.push(v)}),c.allBooks=_.sortBy(c.allBooks,f=>!!f.notInLibrary),c.allBooks=_.uniqBy(c.allBooks,"asin"),c.books=_.uniq(c.books)),s.$store.commit("update",{key:"progress.step",add:1}),o(c)},flatten:!0,done:function(i){n(null,i)}})},getMissingNumbers:function(t,e,n){let s=[];_.each(e,function(i){let o=_.filter(i.allBooks,{bookNumbers:"\u221E"});o.length&&(o=_.map(o,function(a){return{requestUrl:window.location.origin+"/pd/"+a.asin,seriesAsin:i.asin,bookAsin:a.asin}}),s=s.concat(o))}),this.$store.commit("update",[{key:"progress.text",value:"Attempting to fetch missing numbers from store pages..."},{key:"progress.step",value:0},{key:"progress.max",value:s.length},{key:"progress.bar",value:!0},{key:"subStep.step",add:1}]);let r=this;r.amapxios({requests:s,returnCatch:!0,step:function(i,o,a){let l=null;const c=_.get(i,"status",0);if(c>=200&&c<400){let u=$($.parseHTML(i.data)),f=u.find("div.adbl-main")[0];if(u=null,f&&f.querySelector('[id^="sample-player-"] > button')){const p=f.querySelector(".seriesLabel");let h=r.getSeries(p);h&&(h=_.find(h,{asin:a.seriesAsin}));const m=_.get(h,"bookNumbers");m&&(l={seriesAsin:a.seriesAsin,asin:a.bookAsin,bookNumbers:_.isArray(m)?m.join(", "):m})}}r.$store.commit("update",{key:"progress.step",add:1}),o(l)},flatten:!0,done:function(i){i=_.omitBy(i,_.isNull),_.each(i,function(o){let a=_.find(e,{asin:o.seriesAsin});if(a){let l=_.find(a.allBooks,{asin:o.asin});l&&(l.bookNumbers=o.bookNumbers)}}),n(null,e)}})},fetchMissingNumbers:function(t,e,n){let s=this;s.amapxios({requests:_.map(t,function(r){return{requestUrl:window.location.origin+"/pd/"+r.asin,seriesAsin:e.asin,bookAsin:r.asin}}),step:function(r,i,o){let a=null;const l=_.get(r,"status",0);if(l>=200&&l<400){let c=$($.parseHTML(r.data)),u=c.find("div.adbl-main")[0];if(c=null,u&&u.querySelector('[id^="sample-player-"] > button')){const f=u.querySelector(".seriesLabel");let p=s.getSeries(f);p&&(p=_.find(p,{asin:o.seriesAsin}));const h=_.get(p,"bookNumbers");h&&(a={seriesAsin:o.seriesAsin,asin:o.bookAsin,bookNumbers:_.isArray(h)?h.join(", "):h})}}i(a)},flatten:!0,done:function(r){_.each(r,function(i){let o=_.find(e.allBooks,{asin:i.asin});o&&(o.bookNumbers=i.bookNumbers)}),s.$store.commit("update",{key:"progress.step",add:1}),n(e)}})}}},au={methods:{getDataFromCollections:function(t,e){if(!_.find(t.config.steps,{name:"collections"}))this.$store.commit("resetProgress"),e(null,t);else{this.$store.commit("update",[{key:"bigStep.step",value:0}]),this.$store.commit("update",[{key:"bigStep.title",value:"Collections"},{key:"bigStep.step",add:1},{key:"progress.text",value:"Fetching collections..."},{key:"progress.step",value:0},{key:"progress.max",value:0},{key:"progress.bar",value:!0}]);const n=this;waterfall([function(s){n.uniteBooksInCollections(t,s)},n.fetchCollectionDetails],function(s,r){t.collections=r,n.$store.commit("resetProgress"),n.$nextTick(function(){e(null,t)})})}},uniteBooksInCollections:function(t,e){const n=_.filter(t.books,"collectionIds"),s=[],r=this;_.each(n,function(i){_.each(i.collectionIds,function(o){let a=_.find(s,{id:o});a||(a={id:o,url:r.collectionsUrl+"/"+o,books:[]},s.push(a),r.$store.commit("update",{key:"progress.max",add:1})),a&&a.books.push(i.asin)})}),e(null,s)},fetchCollectionDetails:function(t,e){const n=this;this.amapxios({requests:t,step:function(s,r,i){const o=$($.parseHTML(s.data)).find("div.adbl-main")[0];let a=o.querySelector("#center-3 > div.bc-container > div > div > span > ul > li:nth-child(1) > span.bc-text.bc-size-headline2");a&&(a=a.textContent),a&&(i.title=a);let l=o.querySelector("#center-3 > div.bc-container > div > div > span > ul > li.bc-list-item.summaryLabel.bc-spacing-s0_5 > span");l&&(l=l.textContent),l&&(i.description=l),n.$store.commit("update",{key:"progress.step",add:1}),r(i)},flatten:!0,done:function(s){_.each(s,function(r){r.url&&delete r.url}),e(null,s)}})},getFirstLevelCollectionData:function(t,e){const n=this;n.$store.commit("update",[{key:"progress.text",value:"Fetching collections..."},{key:"progress.step",value:0},{key:"progress.max",value:0},{key:"progress.bar",value:!0}]),n.amapxios({requests:t,step:function(s,r){n.scrapeFirstLevelCollectionData(s,r)},flatten:!0,done:function(s){e(null,s)}})},scrapeFirstLevelCollectionData:function(t,e){const n=this,s=$($.parseHTML(t.data)).find("div.adbl-main")[0];t.data=null;const r=[],i=s.querySelectorAll("#adbl-lib-col-main > .adbl-library-collection-row");each(i,function(o){if(o.querySelector(".product-image-grid-container:not(.empty-product-image-grid)")){let l={};const c=o.getAttribute("data-collection-id");l.id=DOMPurify.sanitize(c);const u=o.querySelector(".bc-size-headline3");u&&(l.title=DOMPurify.sanitize(u.textContent));const f=o.querySelector("ul .bc-text.bc-size-body.bc-color-secondary");f&&(l.description=DOMPurify.sanitize(f.textContent)),l.books=[],r.push(l)}n.$store.commit("update",{key:"progress.max",add:1})}),e(r)},getAllCollectionBookPages:function(t,e){const n=this;_.each(t,function(s){s.url=n.collectionsUrl+"/"+s.id+"?pageSize=50"}),n.amapxios({requests:t,step:function(s,r,i){n.scrapingPrep({url:s.request.responseURL||i.url,skipFirstCall:!0,response:s,done:function(o){n.$store.commit("update",{key:"progress.max",add:1}),i.pageNumbers=o.pageNumbers,i.pageSize=o.pageSize,i.url=o.urlObj.toString(),r(i)}})},flatten:!0,done:function(s,r){let i=[];r?console.log(r):_.each(s,function(o){_.each(o.pageNumbers,function(a){const l=JSON.parse(JSON.stringify(o));let c=new Url(DOMPurify.sanitize(l.url));c.query.page=a,c.query.pageSize=o.pageSize,l.url=c.toString(),i.push(l)})}),e(null,i,s)}})},getFirstLevelCollectionPages:function(t){this.scrapingPrep({url:this.collectionsUrl,done:function(e){const n=_.map(e.pageNumbers,function(s){return e.urlObj.query.page=s,e.urlObj.toString()});t(null,n)}})}}},lu={methods:{getDataFrompUserReviews:function(t,e){if(!_.find(t.config.steps,{name:"userReviews"}))this.$store.commit("resetProgress"),e(null,t);else{this.$store.commit("update",[{key:"bigStep.step",value:0}]),this.$store.commit("update",[{key:"bigStep.title",value:"My reviews"},{key:"bigStep.step",add:1},{key:"progress.text",value:"Fetching user reviews..."},{key:"progress.step",value:0},{key:"progress.max",value:0},{key:"progress.bar",value:!0}]);const n=this;this.scrapingPrep({url:this.listenerUrl,done:s=>{const r=_.map(s.pageNumbers,function(i){return s.urlObj.query.page=i,s.urlObj.toString()});this.amapxios({requests:r,step:(i,o,a)=>{const c=$($.parseHTML(i.data)).find("div.adbl-main")[0].querySelectorAll(".bc-container > .bc-row-responsive"),u=[];_.each(c,f=>{const p={},h=f.querySelector(".listenerReviews1"),m=h.previousElementSibling,g=h.querySelector(":scope > h4");p.title=DOMPurify.sanitize(g.textContent.trimAll());const y=m.querySelector(".adbl-asin-impression");p.asin=DOMPurify.sanitize(y.getAttribute("data-asin"));const v=h.querySelector("p.bc-size-body.bc-color-secondary");v&&(p.summary=DOMPurify.sanitize(n.getSummary(v)));const T=h.querySelectorAll(".bc-review-stars");p.ratings=[],_.each(T,O=>{const w=O.previousElementSibling;if(w){const E=w.textContent.trim();E&&p.ratings.push({name:DOMPurify.sanitize(E),stars:DOMPurify.sanitize(O.querySelectorAll(".full-review-star").length)})}}),u.push(p),n.$store.commit("update",{key:"progress.max",add:1}),n.$store.commit("update",{key:"progress.step",add:1})}),o(u)},flatten:!0,done:i=>{t.userReviews=i,n.$store.commit("resetProgress"),n.$nextTick(function(){e(null,t)})}})}})}}}},cu={methods:{getDataFromWishlist:function(t,e){if(!_.find(t.config.steps,{name:"wishlist"}))this.$store.commit("resetProgress"),e(null,t);else{this.$store.commit("update",[{key:"bigStep.step",value:0}]),this.$store.commit("update",[{key:"bigStep.title",value:"Wishlist"},{key:"bigStep.step",add:1},{key:"subStep.step",value:1},{key:"subStep.max",value:2},{key:"progress.text",value:this.$store.state.storageHasData.wishlist?"Updating old books and adding new books...":"Scanning wishlist for books..."},{key:"progress.step",value:0},{key:"progress.max",value:0}]);const n=this;waterfall([function(s){n.scrapingPrep({url:n.wishlistUrl,returnResponse:!0,returnAfterFirstCall:!0,done:function(r){const i=_.get(r,"response.data");i||s(null,r);const a=$($.parseHTML(i)).find("div.adbl-main")[0].querySelector(".adbl-library-refinement-section > div:nth-child(1) span");let l=a?a.textContent:null;l&&(l=parseFloat(DOMPurify.sanitize(l.match(/\d+/)[0]))),delete r.response;const c=r.pageSize?Math.ceil(l/r.pageSize):1;r.pageNumbers=_.range(1,c+1),s(null,r)}})},function(s,r){n.amapxios({requests:_.map(s.pageNumbers,function(i){return s.urlObj.query.page=i,s.urlObj.toString()}),step:function(i,o){n.getBooksWishlist(i,t,o)},flatten:!0,done:function(i){r(null,i)}})}],function(s,r){r.length&&(t.books=(t.books||[]).concat(r)),n.$nextTick(function(){t.config.getStorePages="wishlist",e(null,t)})})}},getBooksWishlist:function(t,e,n){let s=this;const r=$($.parseHTML(t.data)).find("div.adbl-main")[0];t.data=null;const i=[],o=r.querySelectorAll("#adbl-library-content-main li.productListItem");$(o).each(function(){const a=this;let l=a.querySelector("[data-asin]");if(l&&(l=l.getAttribute("data-asin")),l||(l=a.querySelector('[id^="product-list-flyout-"]'),l&&(l=l.getAttribute("id").replace("product-list-flyout-",""))),l=DOMPurify.sanitize(l),e.books?!_.find(e.books,{asin:l}):!0){let u=_.find(e.books,["asin",l]),f=s.$store.state.storageHasData.wishlist&&!u||!s.$store.state.storageHasData.wishlist,p=s.$store.state.storageHasData.wishlist&&u?u:{};p.asin=l;let h=a.querySelector(":scope > div:nth-child(1) > div > div > div > div > div > span > ul > li:nth-child(1) > a");if(h){let R=h.getAttribute("href");R=DOMPurify.sanitize(R);let C=new Url(window.location.origin+R);C.clearQuery(),p.storePageRequestUrl=C.toString()}if(f){const R=a.querySelector(":scope > div:nth-child(1) > div > div > div > div > div > span > ul > li:nth-child(2) > span.bc-color-secondary");R&&(p.subtitle=DOMPurify.sanitize(R.textContent.trimAll())),h&&(h=h.textContent.trimAll(),p.titleShort=DOMPurify.sanitize(h),p.title=p.subtitle?h+": "+p.subtitle:h);const C=a.querySelector("[data-mp3]");C&&(p.sample=DOMPurify.sanitize(C.getAttribute("data-mp3")));const B=a.querySelector(".seriesLabel > span");B&&(p.series=s.getSeries(B));const q=a.querySelector(".runtimeLabel > span");q&&(p.length=s.shortenLength(q.textContent));const G=a.querySelector(".releaseDateLabel > span");G&&(p.releaseDate=s.fixDates(G));const me=a.querySelectorAll(".authorLabel > a");me.length>0&&(p.authors=s.getArray(me));const at=a.querySelectorAll(".narratorLabel > a");at.length>0&&(p.narrators=s.getArray(at));const lt=a.querySelector(".languageLabel");lt&&(p.language=DOMPurify.sanitize(lt.textContent.trimToColon()))}const m=a.querySelector('[data-trigger^="product-list-flyout"]');if(m){let R=m.querySelector(":scope > a");if(R){let C=R.getAttribute("src");if(!C){const B=R.querySelector(":scope > img");B&&(C=B.getAttribute("src"))}if(C=DOMPurify.sanitize(C),C&&C.lastIndexOf("img-coverart-prod-unavailable")<0){let B=C.match(/\/images\/I\/(.*)._SL/);B=_.get(B,"[1]"),B&&(p.cover=B)}}}if(a.querySelector(".ratingsLabel")){const R=a.querySelector(".bc-review-stars");if(R){const C=R.nextElementSibling,B=C.nextElementSibling;p.rating=Number(DOMPurify.sanitize(C.textContent.match(/^\d\.?(\d)?/g)));let q=B.textContent;q&&(q=DOMPurify.sanitize(q),q=q.match(/\d/g),q=_.isArray(q)?_.join(q,""):q,q=parseFloat(q),p.ratings=q)}}a.querySelector(".discovery-add-to-library-button")&&(p.fromPlusCatalog=!0);const v=R=>{if(R=_.isString(R)?a.querySelector(R):R,!R)return;let C=R.textContent;return C=DOMPurify.sanitize(C),C=C.trimAll(),C=C.match(/\d+(\.|\,)?/gm),C=_.isArray(C)?_.join(C,""):C,C=parseFloat(C),C},T=a.querySelector("#adbl-buy-box-container"),O=T?T.querySelector('[id^="buybox-regular-price"]'):null,w=O?O.querySelector(":scope > span.bc-text-strike"):null,E=T?T.querySelector(' [id^="buybox-member-price"]'):null;if(!w&&O){const R=v(O);R>-1&&(p.price=R)}else if(w&&E){const R=v(E.querySelector(".bc-color-price"));R>-1&&(p.price=R)}let N;const U=a.querySelector(".adblSaleHasEnded");if(U){let R=U.getAttribute("hidden");R&&(R=DOMPurify.sanitize(R)),N=!_.isNil(R)&&R!=!1}const j=a.querySelector(".adblSaleTimerContainer");if(j&&!N&&(p.onSale=!0),j){const R=a.querySelector('[id^="buybox-sale-price"]');if(R){const C=R.querySelector(".sale-discount-percentage");if(C){const B=C.previousElementSibling;if(B){const q=v(B);q>-1&&(p.price=q)}}}}if(p=_.omitBy(p,_.isNil),s.$store.state.storageHasData.books){let R=!u,C=u&&u.isNew;(R||C)&&(p.isNew=!0)}f&&(p.isNewThisRound=!0,s.$store.commit("update",{key:"progress.max",add:1})),i.push(p)}}),n(i)}}},uu={methods:{getDataFromPurchaseHistory:function(t,e){const n=this;n.scrapingPrep({url:n.purchaseHistoryUrl,maxSize:20,done:function(s){s.urlObj.toString(),console.log(s)}})}}},du={mixins:[Ur,Hr,eu,tu,su,ru,iu,nu,Ns,au,lu,cu,Ns,uu,bn],data:function(){return{store:this.$store.state,libraryUrl:window.location.origin+"/library/titles",libraryUrlFin:window.location.origin+"/library/titles?isFinished=true",seriesUrl:window.location.origin+"/series",collectionsUrl:window.location.origin+"/library/collections",wishlistUrl:window.location.origin+"/library/wishlist",listenerUrl:window.location.origin+"/listener",podcastsUrl:window.location.origin+"/library/podcasts",purchaseHistoryUrl:window.location.origin+"/account/purchase-history",domainExtension:window.location.hostname.replace("www.audible",""),newBooks:[],library:{books:[],storePageMissing:[]},ui:"menu-screen",doStorePageTest:[],doSeriesTest:[]}},beforeMount:function(){this.$compEmitter.on("start-extraction",t=>{this["init_step_"+t.step](t.config)}),_.get(this.doStorePageTest,"length",0)>0&&this.init_storePageTest(),_.get(this.doSeriesTest,"length",0)>0&&this.init_seriesPageTest()},methods:{init_step_extract:function(t){const e=this;chrome.storage.local.get(null).then(n=>{n.chunks&&n.chunks.length&&e.glueFriesBackTogether(n),e.ui="scraping",e.$nextTick(function(){n=n||{},n.books&&(t.oldBooksLength=n.books.length),n.config=t;const s=[function(i){i(null,n)},e.getDataFromLibraryPages,e.getDataFromStorePages,e.getDataFromSeriesPages,function(i,o){if(!_.find(i.config.steps,{name:"books"})){o(null,i);return}e.saveExtractionSoFar(i,a=>{o(null,a)})},e.getDataFromCollections,e.getDataFrompUserReviews,function(i,o){e.saveExtractionSoFar(i,a=>{if(!_.find(a.config.steps,{name:"wishlist"})){e.$store.commit("resetProgress"),o(null,a);return}e.$store.commit("update",{key:"checkingWishlistAccess",value:!0}),e.$store.commit("update",{key:"noWishlistAccess",value:!1}),e.checkAccess({to:e.wishlistUrl,success:function(l){o(null,a)},failed:function(l){e.$store.commit("update",{key:"noWishlistAccess",value:!0})},finally:function(){e.$store.commit("update",{key:"checkingWishlistAccess",value:!1})}})})},e.getDataFromWishlist,e.getDataFromStorePages,e.getDataFromSeriesPages,function(i,o){if(!_.find(i.config.steps,{name:"wishlist"})){e.$store.commit("resetProgress"),o(null,i);return}e.saveExtractionSoFar(i,a=>{o(null,a)})},e.getISBNsFromGoogleBooks],r=t.steps?_.filter(t.steps,function(i){return i.value}).length:s.length-1;e.$store.commit("update",{key:"bigStep.max",value:r}),waterfall(s,function(i,o){e.$store.commit("resetProgress"),e.$store.commit("update",[{key:"bigStep.title",value:"Opening the gallery after packing up the data..."},{key:"bigStep.step",value:0},{key:"bigStep.max",value:0},{key:"subStep.step",value:0},{key:"subStep.max",value:0}]),e.goToOutputPage(o)})})})},init_step_update:function(t){t.partialScan=!0,t.steps=[{name:"library",value:!0}],this.init_step_extract(t)},init_step_output:function(t){let e={config:t,extras:{"domain-extension":this.domainExtension}};chrome.storage.local.set(e).then(()=>{this.goToOutputPage({useStorageData:!0})})},outputCleanup(t){let e=t.collections,n=e?_.find(e,{id:"__ARCHIVE"}):null;n&&(n.description="");let s=function(r){t[r]&&_.each(t[r],function(i){i.storePageRequestUrl&&delete i.storePageRequestUrl,i.isNewThisRound&&delete i.isNewThisRound,i.requestUrl&&delete i.requestUrl,r==="books"&&i.asin&&_.get(n,"books.0")&&_.includes(n.books,i.asin)&&(i.archived=!0),r==="books"&&_.each(i.series,o=>{const a=_.find(t.series,{asin:o.asin});if(!_.includes(a.books,i.asin)){a.detachedBooks=!0,a.books.push(i.asin);const c=_.pick(i,["titleShort","title","cover","bookNumbers","asin"]);c.bookNumbers=_.isArray(o.bookNumbers)?o.bookNumbers.join(", "):o.bookNumbers;const u=_.first(o.bookNumbers),f=_.findLastIndex(a.allBooks,p=>p.bookNumbers==u||p.bookNumbers==c.bookNumbers);f>-1?a.allBooks.splice(f+1,0,c):a.allBooks.push(c)}})})};s("books"),s("wishlist"),_.each(t.series,r=>{r.allBooks=_.sortBy(r.allBooks,i=>!!i.notInLibrary),r.allBooks=_.uniqBy(r.allBooks,"asin")}),_.get(t,"books.0")&&_.get(t,"wishlist.0")&&_.remove(t.wishlist,function(r){if(r.asin)return _.find(t.books,{asin:r.asin})})},saveExtractionSoFar(t,e){let n=this;if(this.outputCleanup(t),t.config&&(t.config.steps||t.config.extraSettings)){let s=t.config.steps,r=t.config.extraSettings;t.config={},s&&(t.config.steps=s),r&&(t.config.extraSettings=r)}this.addDataVersions(t),t.chunks||(t.books&&this.addedOrder(t.books),t.books&&this.languageCorrections(t.books),t.wishlist&&this.addedOrder(t.wishlist),this.makeFrenchFries(t)),chrome.storage.local.clear().then(()=>{chrome.storage.local.set(t).then(()=>{_.get(t,"chunks.0")&&n.glueFriesBackTogether(t),e(t)})})},languageCorrections(t){_.each(t,(e,n)=>{switch(e.progress){case"Beendet":e.progress="Finished";break}})},goToOutputPage:function(t){const e=window.location.origin+window.location.pathname;this.$store.commit("update",{key:"sticky.openOnLoad",value:!0}),t.useStorageData?chrome.runtime.sendMessage({action:"openOutput",url:e}):this.saveExtractionSoFar(t,()=>{chrome.runtime.sendMessage({action:"openOutput",url:e})})},addDataVersions:function(t){_.isObject(t.version)||(t.version={});let e=this.store.storageHasData,n=chrome.runtime.getManifest().version;_.find(_.get(t,"config.steps"),{name:"library",value:!0})&&!e.books&&(t.version.library=n),_.find(_.get(t,"config.steps"),{name:"collections",value:!0})&&!e.collections&&(t.version.collections=n),_.find(_.get(t,"config.steps"),{name:"wishlist",value:!0})&&!e.wishlist&&(t.version.wishlist=n)},init_purchaseHistoryTest:function(){const t={config:{test:!0,getStorePages:"books"}};this.getDataFromPurchaseHistory(t,function(e,n){console.log("%cPurchase history test","background: #00bb1e; color: #fff; padding: 2px 5px; border-radius: 8px;",n)})},init_storePageTest:function(){const t=this;console.log("%casdfasdf","background: green; color: #fff; padding: 2px 5px; border-radius: 8px;",this.doStorePageTest);const e={config:{test:!0,getStorePages:"books",seriesTest:!0},books:this.doStorePageTest};console.log("%casdfasdf","background: orange; color: #fff; padding: 2px 5px; border-radius: 8px;",e);const n=[function(s){s(null,e)},t.getDataFromStorePages,t.getDataFromSeriesPages];console.log("waterfall","waterfall"),waterfall(n,function(s,r){t.$store.commit("resetProgress"),t.$store.commit("update",[{key:"bigStep.title",value:"Opening the gallery after packing up the data..."},{key:"bigStep.step",value:0},{key:"bigStep.max",value:0}]),console.log("%cStore page test","background: #00bb1e; color: #fff; padding: 2px 5px; border-radius: 8px;",r)})},init_seriesPageTest:function(){const t=this,e={config:{seriesTest:!0},books:this.doSeriesTest};t.getDataFromSeriesPages(e,function(n,s){console.log("%cSeries page test","background: #00bb1e; color: #fff; padding: 2px 5px; border-radius: 8px;",s.series)})},checkAccess:function(t){t=t||{},axios.get(t.to).then(function(){t.success&&t.success()}).catch(function(e){t.failed&&t.failed(e)}).then(function(){t.finally&&t.finally()})}}};function fu(t,e,n,s,r,i){const o=Qc,a=El,l=cl;return D(),ve(l,null,{default:vt(()=>[t.ui==="menu-screen"?(D(),ve(o,{key:0,domainExtension:t.domainExtension,wishlistUrl:t.wishlistUrl},null,8,["domainExtension","wishlistUrl"])):t.ui==="scraping"?(D(),ve(a,{key:1,domainExtension:t.domainExtension},null,8,["domainExtension"])):Ce("",!0)]),_:1})}const Nu=Te(du,[["render",fu]]),Mu=Jr({state:{appVersion:"0.2.12",localStorageName:"ale-content-script-settings",canceledRequests:[],progress:{text:null,textSuffix:null,text2:null,step:0,max:0,bar:!1,thumbnail:null},bigStep:{title:"",step:0,max:0},subStep:{step:0,max:0},storageHasData:{books:null,isbn:null,wishlist:null,collections:null,userReviews:null},toastOpts:{position:"top",duration:4e3},storageConfig:{},dataVersion:null,extractBtnDisabled:!1,extractionButtonDisabled:!1,axiosRateLimit:{maxRequests:10,perMilliseconds:1e3},failedRequests:[],lastFailedRequestStatus:null,taking_a_break:!1,noWishlistAccess:!1,checkingWishlistAccess:!1,sticky:{openOnLoad:!1,extractSettings:[{label:"Library",name:"books",value:!0,disabled:!0,type:"is-success",tippy:"Library is required in order to extract collections and isbn.",trashTippy:"This will also remove Collections and ISBN data.",kind:"main",deleteChunks:["books","series","collections"],partialData:!0},{label:"Collections",name:"collections",parent:"books",value:!0,disabled:!1,type:"is-success",tippy:"Very quick extraction that just needs to check the first page of each collection to find out the title and description",kind:"main",partialData:!1},{label:"My Reviews",name:"userReviews",value:!1,disabled:!1,type:"is-success",tippy:"",kind:"main",partialData:!1},{label:"Wishlist",name:"wishlist",value:!1,disabled:!1,type:"is-success",tippy:"Similar to library extraction but series order is not fetched. Books that also exist in your library are dropped off as long as you also extract library data.",kind:"main",partialData:!0},{label:"ISBN",name:"isbn",parent:"books",value:!1,disabled:!1,type:"is-danger",tippy:"International Standard Book Numbers (ISBN) are required if you want to try importing your library to Goodreads. ISBNs are fetched for library books only. Very slow extraction time.",kind:"main",partialData:!0},{name:"saveStandaloneAfter",value:!1,label:"Save standalone gallery after extraction",kind:"extra"},{name:"saveCSVAfter",value:!1,label:"Save  CSV spreadsheet after extraction",kind:"extra"}],slowExtract:!1}},mutations:{fromLocalStorage:function(t){let e=localStorage.getItem(t.localStorageName);if(e&&e!="undefined"){e=JSON.parse(e);const n=_.map(e.extractSettings,function(s){return{disabled:s.disabled,value:s.value}});e.extractSettings=[],_.merge(t.sticky,e),_.merge(t.sticky.extractSettings,n)}},update(t,e){let n=function(s){if(s=s||{},s.key){let r=s.value;s.add&&(r=(_.get(t,s.key)||0)+s.add),r=s.freeze?Object.freeze(r):r,_.set(t,s.key,r)}};_.isArray(e)?_.each(e,function(s){n(s)}):n(e)},resetProgress:function(t){t.progress.text=null,t.progress.textSuffix=null,t.progress.text2=null,t.progress.step=0,t.progress.max=0,t.progress.bar=!1,t.progress.thumbnail=null},pushToCanceledRequests:function(t,e){t.canceledRequests.push(e)},updateSetting:function(t,e){e=_.castArray(e),_.each(e,function(n){const s=_.find(t.sticky.extractSettings,{name:n.item.name});_.merge(s,n.obj)})},pushToFailedRequests(t,e){t.failedRequests.push(e)}},getters:{settings_mainSteps:function(t){return _.filter(t.sticky.extractSettings,{kind:"main"})},settings_extras:function(t){return _.filter(t.sticky.extractSettings,{kind:"extra"})},mainDataExists:function(t){return t.storageHasData.books||t.storageHasData.wishlist},setting:t=>e=>_.find(t.sticky.extractSettings,{name:e}),partialDataSettings(t,e){const n=_.filter(e.settings_mainSteps,{partialData:!0}),s=_.map(n,"name"),r=_.map(s,i=>_.get(t.storageHasData,i));return _.every(r,!0)},partialDataSettings(t,e){const n=_.filter(e.settings_mainSteps,{partialData:!0}),s=_.map(n,"name");return _.map(s,r=>_.get(t.storageHasData,r))},partialDataSettings_all(t,e){return _.every(e.partialDataSettings,!0)},partialDataSettings_any(t,e){return _.includes(e.partialDataSettings,!0)}}}),pu=t=>{typeof t.remove<"u"?t.remove():t.parentNode.removeChild(t)};class mu{constructor(e,n){this.startedAt=Date.now(),this.callback=e,this.delay=n,this.timer=setTimeout(e,n)}pause(){this.stop(),this.delay-=Date.now()-this.startedAt}resume(){this.stop(),this.startedAt=Date.now(),this.timer=setTimeout(this.callback,this.delay)}stop(){clearTimeout(this.timer)}}const De={TOP_RIGHT:"top-right",TOP:"top",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom-left"},Ms=Object.freeze(De);function Is(t,e,n){let s=null;switch(t){case De.TOP:case De.TOP_RIGHT:case De.TOP_LEFT:s=e;break;case De.BOTTOM:case De.BOTTOM_RIGHT:case De.BOTTOM_LEFT:s=n;break}return s}class hu{constructor(){this.queue={}}$on(e,n){this.queue[e]=this.queue[e]||[],this.queue[e].push(n)}$off(e,n){if(this.queue[e]){for(var s=0;s<this.queue[e].length;s++)if(this.queue[e][s]===n){this.queue[e].splice(s,1);break}}}$emit(e,n){this.queue[e]&&this.queue[e].forEach(function(s){s(n)})}}const gn=new hu;const gu={name:"toast",props:{message:{type:String,required:!0},type:{type:String,default:"default"},position:{type:String,default:Ms.BOTTOM_RIGHT,validator(t){return Object.values(Ms).includes(t)}},maxToasts:{type:[Number,Boolean],default:!1},duration:{type:[Number,Boolean],default:4e3},dismissible:{type:Boolean,default:!0},queue:{type:Boolean,default:!1},pauseOnHover:{type:Boolean,default:!0},useDefaultCss:{type:Boolean,default:!0},onClose:{type:Function,default:()=>{}},onClick:{type:Function,default:()=>{}}},data(){return{isActive:!1,parentTop:null,parentBottom:null,isHovered:!1,timer:null}},beforeMount(){this.createParents(),this.setDefaultCss(),this.setupContainer()},mounted(){this.showNotice(),gn.$on("toast-clear",this.close)},methods:{createParents(){this.parentTop=document.querySelector(".c-toast-container--top"),this.parentBottom=document.querySelector(".c-toast-container--bottom"),!(this.parentTop&&this.parentBottom)&&(this.parentTop||(this.parentTop=document.createElement("div"),this.parentTop.className="c-toast-container c-toast-container--top"),this.parentBottom||(this.parentBottom=document.createElement("div"),this.parentBottom.className="c-toast-container c-toast-container--bottom"))},setDefaultCss(){const t=this.useDefaultCss?"add":"remove";this.parentTop.classList[t]("v--default-css"),this.parentBottom.classList[t]("v--default-css")},setupContainer(){const t=document.body;t.appendChild(this.parentTop),t.appendChild(this.parentBottom)},shouldQueue(){return!this.queue&&this.maxToasts===!1?!1:this.maxToasts!==!1?this.maxToasts<=this.parentTop.childElementCount+this.parentBottom.childElementCount:this.parentTop.childElementCount>0||this.parentBottom.childElementCount>0},showNotice(){if(this.shouldQueue()){this.queueTimer=setTimeout(this.showNotice,250);return}this.correctParent.insertAdjacentElement("afterbegin",this.$el),this.isActive=!0,this.timer=this.duration!==!1?new mu(this.close,this.duration):null},click(){this.onClick.apply(null,arguments),this.dismissible&&this.close()},toggleTimer(t){this.timer&&this.pauseOnHover&&(t?this.timer.pause():this.timer.resume())},stopTimer(){this.timer&&this.timer.stop(),clearTimeout(this.queueTimer)},close(){this.stopTimer(),this.isActive=!1,setTimeout(()=>{this.onClose.apply(null,arguments),pu(this.$el)},150)}},computed:{correctParent(){return Is(this.position,this.parentTop,this.parentBottom)},transition(){return Is(this.position,{enter:"fadeInDown",leave:"fadeOut"},{enter:"fadeInUp",leave:"fadeOut"})}},beforeUnmount(){gn.$off("toast-clear",this.close)}},bu=["innerHTML"];function yu(t,e,n,s,r,i){return D(),ve(on,{"enter-active-class":i.transition.enter,"leave-active-class":i.transition.leave},{default:vt(()=>[oe(S("div",{class:_e(["c-toast",`c-toast--${n.type}`,`c-toast--${n.position}`]),onMouseover:e[0]||(e[0]=o=>i.toggleTimer(!0)),onMouseleave:e[1]||(e[1]=o=>i.toggleTimer(!1)),onClick:e[2]||(e[2]=(...o)=>i.click&&i.click(...o)),role:"alert",innerHTML:n.message},null,42,bu),[[yn,r.isActive]])]),_:1},8,["enter-active-class","leave-active-class"])}const Or=Te(gu,[["render",yu]]),_u=()=>typeof document<"u"&&document.createElement("div"),xu=(t,{props:e,children:n,element:s,app:r}={})=>{let i=s||_u(),o=Yr(t,e,n);return r&&r._context&&(o.appContext=r._context),es(o,i),{vNode:o,destroy:()=>{i&&es(null,i),i=null,o=null},el:i}},wu=(t={})=>({show(e,n={}){let s={message:e,...n};return xu(Or,{props:{...t,...s}})},clear(){gn.$emit("toast-clear")},success(e,n={}){return n.type="success",this.show(e,n)},error(e,n={}){return n.type="error",this.show(e,n)},info(e,n={}){return n.type="info",this.show(e,n)},warning(e,n={}){return n.type="warning",this.show(e,n)}}),Su=(t,e={})=>{let n=wu(e);t.$toast=n,t.config.globalProperties.$toast=n};Or.install=Su;export{Nu as A,Or as T,Ru as a,je as b,Cu as c,oa as e,Ou as f,yr as i,Pu as m,Du as p,Mu as s,Lu as w};
